<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>msiem 0.3.4.dev0 - msiem CLI Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="..">msiem CLI Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Latest</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Versions <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../0.3.3/" class="dropdown-item">msiem 3.3.0</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">msiem 0.3.4.dev0</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    
                      <!-- This comments out the next/previous links in the header -->

                      <!--
                            <li class="nav-item">
                                <a rel="prev" href="../0.3.3/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li> -->
                            <li class="nav-item">
                                <a href="https://github.com/mfesiem/msiem/edit/master/docs/0.3.4.dev0/index.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#msiem_034dev0" class="nav-link">msiem 0.3.4.dev0</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#synopsis" class="nav-link">Synopsis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#description" class="nav-link">Description</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options" class="nav-link">Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_config" class="nav-link">Options 'msiem config'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_alarms" class="nav-link">Options 'msiem alarms'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_esm" class="nav-link">Options 'msiem esm'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_ds" class="nav-link">Options 'msiem ds'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_events" class="nav-link">Options 'msiem events'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_wl" class="nav-link">Options 'msiem wl'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#options_msiem_api" class="nav-link">Options 'msiem api'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#authors" class="nav-link">Authors</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#distribution" class="nav-link">Distribution</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#list_of_all_requests" class="nav-link">List of all requests</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="msiem_034dev0">msiem 0.3.4.dev0<a class="headerlink" href="#msiem_034dev0" title="Permanent link">&para;</a></h1>
<p>Manual</p>
<p>msiem</p>
<p><a name="synopsis"></a></p>
<h1 id="synopsis">Synopsis<a class="headerlink" href="#synopsis" title="Permanent link">&para;</a></h1>
<pre><code>msiem [-h] [-V] {config,alarms,esm,ds,events,wl,api} ...
</code></pre>

<p><a name="description"></a></p>
<h1 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h1>
<p>McAfee SIEM Command Line Interface 0.3.4dev.
Most of the core msiempy features accessible with CLI.    </p>
<p>License: MIT. 
Credits: Andy Walden, Tristan Landes.</p>
<p>Run `msiem &lt;command&gt; --help` for more information about a sub-command.</p>
<p><a name="options"></a></p>
<h1 id="options">Options<a class="headerlink" href="#options" title="Permanent link">&para;</a></h1>
<p><strong>Sub-commands</strong></p>
<ul>
<li><strong>msiem</strong> <em>config</em><br />
  Set and print your msiempy config.  </li>
<li><strong>msiem</strong> <em>alarms</em><br />
  Query alarms with alarms and events based regex filters. Print, acknowledge, unacknowledge and delete alarms.  </li>
<li><strong>msiem</strong> <em>esm</em><br />
  Show ESM version and misc informations regarding your ESM.  </li>
<li><strong>msiem</strong> <em>ds</em><br />
  Add datasources from CSV or INI files, list, search, remove.  </li>
<li><strong>msiem</strong> <em>events</em><br />
  Query events with any simple filter. Add a note to events.  </li>
<li><strong>msiem</strong> <em>wl</em><br />
  Manage watchlists. Export, import values.  </li>
<li><strong>msiem</strong> <em>api</em><br />
  Quickly make API requests to any enpoints with any data.  </li>
</ul>
<p><a name="options-msiem-config"></a></p>
<h1 id="options_msiem_config">Options 'msiem config'<a class="headerlink" href="#options_msiem_config" title="Permanent link">&para;</a></h1>
<p>usage: msiem config [-h] [--print] [--set '&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;']
                    ['&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ...]]</p>
<p>Set and print your msiempy config.  </p>
<p>Set your ESM hostname/user/password interactively:</p>
<pre><code>$ msiem confi --set esm
</code></pre>
<p>Set the general config verbose/quiet/logfile/timeout/ssl_verify interactively:</p>
<pre><code>$ msiem config --set general
</code></pre>
<p>Enable quiet mode (no infos or warnings):</p>
<pre><code>$ msiem config --set general quiet true --set general verbose false
</code></pre>
<ul>
<li>
<p><strong>--print</strong><br />
  Print configuration fields, password base 64 truncated from the output. </p>
</li>
<li>
<p><strong>--set</strong> '&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ['&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ...]<br />
  Set the config option to the specified value if passed (can be repeated), OR inveractively prompt for specified configuration section: 'esm' or 'general'.</p>
</li>
</ul>
<p><a name="options-msiem-alarms"></a></p>
<h1 id="options_msiem_alarms">Options 'msiem alarms'<a class="headerlink" href="#options_msiem_alarms" title="Permanent link">&para;</a></h1>
<p>usage: msiem alarms [-h] [--action action] [--force] [--time_range time_range]
                    [--start_time time] [--end_time time] [--status status]
                    [--filters '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...]]
                    [--event_filters '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...]]
                    [--alarms_fields list of fields [list of fields ...]]
                    [--events_fields list of fields [list of fields ...]]
                    [--json] [--page_size page_size] [--pages pages]
                    [--no_events] [--query_events]</p>
<p>Query alarms with alarms and events based regex filters.<br />
Print, acknowledge, unacknowledge and delete alarms.  </p>
<p>Exemples:  </p>
<p>Acknowledges the (unacknowledged) alarms triggered in the last 
3 days that mention "HTTP: SQL Injection Attempt Detected" in 
the triggered event name and destinated to 10.55.16.99 :</p>
<pre><code>$ msiem alarms --action acknowledge -t LAST_24_HOURS --status unacknowledged --filters "ruleName=HTTP: SQL Injection Attempt Detected" "destIp=10.55.16.99"
</code></pre>
<p>Save the current day alarms as JSON:</p>
<pre><code>$ msiem alarms -t CURRENT_DAY --no_events --json
</code></pre>
<ul>
<li>
<p><strong>--action</strong> action<br />
  What to do with the alarms, if not specified will print only. Chose from 'acknowledge','unacknowledge','delete'</p>
</li>
<li>
<p><strong>--force</strong><br />
  Will not prompt for confirmation to do the specified action</p>
</li>
<li>
<p><strong>--time_range</strong> time_range, <strong>-t</strong> time_range<br />
  Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES, LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY, LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK, PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR</p>
</li>
<li>
<p><strong>--start_time</strong> time, <strong>--t1</strong> time<br />
  Start trigger date</p>
</li>
<li>
<p><strong>--end_time</strong> time, <strong>--t2</strong> time<br />
  End trigger date</p>
</li>
<li>
<p><strong>--status</strong> status<br />
  Status of the alarm. Chose from 'acknowledged','unacknowledged','all'</p>
</li>
<li>
<p><strong>--filters</strong> '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...], <strong>-f</strong> '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...]<br />
  List of alarm related field/matchvalue filters. Repeatable. 
      Alarm related fields can be : id, summary, assignee, severity, triggeredDate, acknowledgedDate, acknowledgedUsername, alarmName, events, and others</p>
</li>
<li>
<p><strong>--event_filters</strong> '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...], <strong>-e</strong> '&lt;field&gt;=&lt;regex&gt;' ['&lt;field&gt;=&lt;regex&gt;' ...]<br />
  List of triggering event related field/matchvalue filters. Repeatable.
      Event related fields can be : ruleName, srcIp, destIp, protocol, lastTime, subtype, destPort, destMac, srcMac, srcPort, deviceName, sigId, normId, srcUser, destUser, normMessage, normDesc, host, domain, ipsId, etc...
      Or (if --query_events) : Rule.msg, Alert.SrcPort, Alert.DstPort, Alert.SrcIP, Alert.DstIP, Alert.SrcMac, Alert.DstMac, Alert.LastTime, Rule.NormID, Alert.DSIDSigID, Alert.IPSIDAlertID, etc...</p>
</li>
<li>
<p><strong>--alarms_fields</strong> list of fields [list of fields ...]<br />
  List of fields that appear in the alarm table. Overwritten by --json</p>
</li>
<li>
<p><strong>--events_fields</strong> list of fields [list of fields ...]<br />
  List of fields that appear in the events sub tables. Default value: ['ruleName', 'srcIp', 'destIp']. If you use --query_events, this list will be used to query needed values, you must specify all fields you want to filter on with ewvent_filters. Default value if --query_events: ['Rule.msg', 'SrcIP', 'DstIP']. Overwritten by --json.</p>
</li>
<li>
<p><strong>--json</strong><br />
  Prints only a JSON object to STDOUT output.  </p>
</li>
<li>
<p><strong>--page_size</strong> page_size, <strong>-p</strong> page_size<br />
  Size of requests</p>
</li>
<li>
<p><strong>--pages</strong> pages, <strong>-n</strong> pages<br />
  Number of alarm pages to load</p>
</li>
<li>
<p><strong>--no_events</strong><br />
  Do not load the complete trigerring events informations. On SIEM v11.x, still load the events infos from notifyGetTriggeredNotification. (Else events field is a string).  </p>
</li>
<li>
<p><strong>--query_events</strong><br />
  Use the query module to retreive events, much more effcient. Event keys will be like 'Alert.SrcIP' instead of 'srcIp'</p>
</li>
</ul>
<p><a name="options-msiem-esm"></a></p>
<h1 id="options_msiem_esm">Options 'msiem esm'<a class="headerlink" href="#options_msiem_esm" title="Permanent link">&para;</a></h1>
<p>usage: msiem esm [-h] [--version] [--time] [--disks] [--ram] [--callhome]
                 [--status] [--timezones]</p>
<p>Show ESM version and misc informations regarding your ESM.</p>
<ul>
<li>
<p><strong>--version</strong><br />
  Show ESM version</p>
</li>
<li>
<p><strong>--time</strong><br />
  time (GMT)</p>
</li>
<li>
<p><strong>--disks</strong><br />
  disk status</p>
</li>
<li>
<p><strong>--ram</strong><br />
  ram status</p>
</li>
<li>
<p><strong>--callhome</strong><br />
  True/False if callhome is active/not active</p>
</li>
<li>
<p><strong>--status</strong><br />
  Statuses and a few other less interesting details : autoBackupEnabled, autoBackupDay, backupLastTime, backupNextTime, rulesAndSoftwareCheckEnabled, rulesAndSoftLastCheck, rulesAndSoftNextCheck</p>
</li>
<li>
<p><strong>--timezones</strong><br />
  Current ESM timezone</p>
</li>
</ul>
<p><a name="options-msiem-ds"></a></p>
<h1 id="options_msiem_ds">Options 'msiem ds'<a class="headerlink" href="#options_msiem_ds" title="Permanent link">&para;</a></h1>
<p>usage: msiem ds [-h] [-a &lt;file or folder&gt;] [-s [term]] [-l]
                [--delete &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--deleteclients &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--force]</p>
<p>Add datasources from CSV or INI files, list, search, remove.  </p>
<p>INI format: Single datasource per file.  </p>
<pre><code>[datasource]
# name of datasource (required)
name=testing_datasource
# ip of datasource (ip or hostname required)
ds_ip=10.10.1.34
# hostname of te new datasource
hostname=
# type of datasource (required)
type_id=65
# id of parent device (required)
parent_id=144116287587483648
# True value designate a client datasource 
client=
</code></pre>
<p>CSV Format: Multiple datasources per file</p>
<pre><code>name,ds_ip,hostname,type_id,parent_id,client
Test_ds_1,10.10.1.41,datasource11.domain.com,65,144116287587483648,
Test_ds_2,10.10.1.42,datasource12.domain.com,65,144116287587483648,
Test_ds_3,10.10.1.43,datasource13.domain.com,65,144116287587483648,
</code></pre>
<p>Add Datasources with: </p>
<pre><code>$ msiem ds --add "File or folder"
</code></pre>
<ul>
<li>
<p><strong>-a</strong> &lt;file or folder&gt;, <strong>--add</strong> &lt;file or folder&gt;<br />
  Scan a directory or a file for new Datasource files and add them to the ESM. Datasources can be defined in CSV or INI format.  </p>
</li>
<li>
<p><strong>-s</strong> [term], <strong>--search</strong> [term]<br />
  Search for datasource name, hostname, or IP.May require quotes around the name if thereare spaces.</p>
</li>
<li>
<p><strong>-l</strong>, <strong>--list</strong><br />
  Display datasources.</p>
</li>
<li>
<p><strong>--delete</strong> &lt;datasource ID&gt; [&lt;datasource ID&gt; ...], <strong>--remove</strong> &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]<br />
  Deletes the datasource and all the data. Be careful.</p>
</li>
<li>
<p><strong>--deleteclients</strong> &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]<br />
  Deletes the datasource's clients and all the data. Be careful.</p>
</li>
<li>
<p><strong>--force</strong><br />
  Do not ask the user input before deletion of the datasources / datasources client.</p>
</li>
</ul>
<p><a name="options-msiem-events"></a></p>
<h1 id="options_msiem_events">Options 'msiem events'<a class="headerlink" href="#options_msiem_events" title="Permanent link">&para;</a></h1>
<p>usage: msiem events [-h] [--time_range time_range] [--start_time &lt;time&gt;]
                    [--end_time &lt;time&gt;] [--filters &lt;filter&gt; [&lt;filter&gt; ...]]
                    [--fields &lt;field&gt; [&lt;field&gt; ...]] [--json] [--limit &lt;int&gt;]
                    [--max &lt;int&gt;] [--grouped] [--add_note &lt;file or text&gt;]
                    [--listfields] [--listfilters]</p>
<p>Query events with filters, add note to events.  </p>
<p>With simple filters:</p>
<pre><code>$ msiem events --filters DstIP=127.0.0.1 SrcIP=22.0.0.0/8 --fields SrcIP DstIP
</code></pre>
<p>Query events with pecific operatior and multiple values filters (filters are ANDed together inside a group filter). 
Print the results as JSON.  </p>
<pre><code>$ msiem events --filter SrcIP IN 22.0.0.0/8 10.0.0.0/8 --filter DSIDSigID IN 49190-4294967295 --fields SrcIP DstIP Rule.msg DSIDSigID --json
</code></pre>
<ul>
<li>
<p><strong>--time_range</strong> time_range, <strong>-t</strong> time_range<br />
  Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES, LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY, LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK, PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR</p>
</li>
<li>
<p><strong>--start_time</strong> &lt;time&gt;, <strong>--t1</strong> &lt;time&gt;<br />
  Start trigger date</p>
</li>
<li>
<p><strong>--end_time</strong> &lt;time&gt;, <strong>--t2</strong> &lt;time&gt;<br />
  End trigger date</p>
</li>
<li>
<p><strong>--filters</strong> &lt;filter&gt; [&lt;filter&gt; ...], <strong>-f</strong> &lt;filter&gt; [&lt;filter&gt; ...]<br />
  List of Event field/value filters: '&lt;field&gt;=&lt;value&gt;' or '&lt;field&gt;' '&lt;operator&gt;' '&lt;value1&gt;' '&lt;value2&gt;...'. Repeatable. Will generate only EsmBasicValue filters. <br />
      Filter fields can be: Rule.msg, Alert.SrcPort, Alert.DstPort, Alert.SrcIP, Alert.DstIP, Alert.SrcMac, Alert.DstMac, Alert.LastTime, Rule.NormID, Alert.DSIDSigID, Alert.IPSIDAlertID, etc...</p>
</li>
<li>
<p><strong>--fields</strong> &lt;field&gt; [&lt;field&gt; ...]<br />
  List of fields that appear in the events table. Default value: ['Rule.msg', 'SrcIP', 'DstIP']. </p>
</li>
<li>
<p><strong>--json</strong><br />
  Prints only a JSON object to STDOUT output.  </p>
</li>
<li>
<p><strong>--limit</strong> &lt;int&gt;<br />
  Size of requests</p>
</li>
<li>
<p><strong>--max</strong> &lt;int&gt;, <strong>--max_query_depth</strong> &lt;int&gt;<br />
  Maximum number of reccursive time based divisions the loading process can apply to the query in order to load all events</p>
</li>
<li>
<p><strong>--grouped</strong><br />
  Indicate a grouped events query, a IPSID filter must be provided and only one field value is accepted. </p>
</li>
<li>
<p><strong>--add_note</strong> &lt;file or text&gt;<br />
  Add a note to the events matching the filters. </p>
</li>
<li>
<p><strong>--listfields</strong><br />
  List all possible fields names</p>
</li>
<li>
<p><strong>--listfilters</strong><br />
  List all possible fields names usable in filters</p>
</li>
</ul>
<p><a name="options-msiem-wl"></a></p>
<h1 id="options_msiem_wl">Options 'msiem wl'<a class="headerlink" href="#options_msiem_wl" title="Permanent link">&para;</a></h1>
<p>usage: msiem wl [-h] [-l] [-t] [-e &lt;wl_name&gt;]
                [--add &lt;wl_name&gt; &lt;wl_type&gt; &lt;wl_name&gt; &lt;wl_type&gt;]
                [--delete &lt;wl ID&gt;]
                [-a &lt;wl_name&gt; &lt;file or values&gt;... [&lt;wl_name&gt; &lt;file or values&gt;... ...]]
                [--rmvalues &lt;wl_name&gt; &lt;file or values&gt;... [&lt;wl_name&gt; &lt;file or values&gt;... ...]]
                [--json]</p>
<p>Watchlist operations. </p>
<ul>
<li>
<p><strong>-l</strong>, <strong>--list</strong><br />
  List the ESM watchlists and exit. </p>
</li>
<li>
<p><strong>-t</strong>, <strong>--types</strong><br />
  List all possible watchlists types and exit. </p>
</li>
<li>
<p><strong>-e</strong> &lt;wl_name&gt;, <strong>--values</strong> &lt;wl_name&gt;<br />
  List watchlist values and exit. Redirect STDOUT to file to export data.  </p>
</li>
<li>
<p><strong>--add</strong> &lt;wl_name&gt; &lt;wl_type&gt; &lt;wl_name&gt; &lt;wl_type&gt;<br />
  NotImplemented. Create a static watchlist.</p>
</li>
<li>
<p><strong>--delete</strong> &lt;wl ID&gt;, <strong>--remove</strong> &lt;wl ID&gt;<br />
  NotImplemented. Deletes a Watchlist</p>
</li>
<li>
<p><strong>-a</strong> &lt;wl_name&gt; &lt;file or values&gt;... [&lt;wl_name&gt; &lt;file or values&gt;... ...], <strong>--addvalues</strong> &lt;wl_name&gt; &lt;file or values&gt;... [&lt;wl_name&gt; &lt;file or values&gt;... ...]<br />
  NotImplemented. Add values to a static watchlist. </p>
</li>
<li>
<p><strong>--rmvalues</strong> &lt;wl_name&gt; &lt;file or values&gt;... [&lt;wl_name&gt; &lt;file or values&gt;... ...]<br />
  NotImplemented. Remove watchlist values from the watchlist. </p>
</li>
<li>
<p><strong>--json</strong><br />
  NotImplemented. Prints only a JSON object to STDOUT output.  </p>
</li>
</ul>
<p><a name="options-msiem-api"></a></p>
<h1 id="options_msiem_api">Options 'msiem api'<a class="headerlink" href="#options_msiem_api" title="Permanent link">&para;</a></h1>
<p>usage: msiem api [-h] [-m &lt;method&gt;] [-d &lt;JSON string or file&gt;]
                 [-a &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]] [-l]</p>
<p>Quickly make API requests to any enpoints with any data. Print resposne to sdtout as JSON.   </p>
<p>Request v2/alarmGetTriggeredAlarms:  </p>
<pre><code>$ msiem api --method "v2/alarmGetTriggeredAlarms?triggeredTimeRange=LAST_24_HOURS&amp;status=&amp;pageSize=500&amp;pageNumber=1"
</code></pre>
<ul>
<li>
<p><strong>-m</strong> &lt;method&gt;, <strong>--method</strong> &lt;method&gt;<br />
  SIEM API method name or NitroSession.PARAMS keyword. Exemple: 'v2/qryGetSelectFields' or 'get_possible_fields', see 'msiem api --list' for full details .</p>
</li>
<li>
<p><strong>-d</strong> &lt;JSON string or file&gt;, <strong>--data</strong> &lt;JSON string or file&gt;<br />
  POST data, in the case of a API method name call.  See the SIEM API docs for full details.  </p>
</li>
<li>
<p><strong>-a</strong> &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...], <strong>--args</strong> &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]<br />
  Interpolation parameters, in the case of a NitroSession.PARAMS keyword call.  See 'msiem api --list' for full details.  </p>
</li>
<li>
<p><strong>-l</strong>, <strong>--list</strong><br />
  List all available SIEM API calls as well as all supported calls with keywords and parameter mapping. All upper cases method names signals to use the private API methods. </p>
</li>
<li>
<p><strong>-V</strong>, <strong>--version</strong><br />
  Show version and exit</p>
</li>
</ul>
<p><a name="authors"></a></p>
<h1 id="authors">Authors<a class="headerlink" href="#authors" title="Permanent link">&para;</a></h1>
<p><strong>msiem</strong>
was written by Andy Walden, Tristan Landes &lt;&lt;&lt;UNSET --author_email OPTION&gt;&gt;&gt;.</p>
<p><a name="distribution"></a></p>
<h1 id="distribution">Distribution<a class="headerlink" href="#distribution" title="Permanent link">&para;</a></h1>
<p>The latest version of msiem may be downloaded from GitHub
<a href="https://github.com/mfesiem/msiem"></a></p>
<h1 id="list_of_all_requests">List of all requests<a class="headerlink" href="#list_of_all_requests" title="Permanent link">&para;</a></h1>
<p>Generated with msiempy 0.3.5 from ESM 11.3.0 </p>
<p><code>$ msiem api --list</code></p>
<pre><code>All possible SIEM requests: 
msiem api --method v2/alarmAcknowledgeTriggeredAlarm --data &lt;JSON string or file&gt;
msiem api --method v2/alarmDeleteTriggeredAlarm --data &lt;JSON string or file&gt;
msiem api --method v2/alarmGetTriggeredAlarms --data &lt;JSON string or file&gt;
msiem api --method v2/alarmUnacknowledgeTriggeredAlarm --data &lt;JSON string or file&gt;
msiem api --method v2/assetGetAssetDetailsObject --data &lt;JSON string or file&gt;
msiem api --method v2/assetGetAssetThreats --data &lt;JSON string or file&gt;
msiem api --method v2/caseAddCase --data &lt;JSON string or file&gt;
msiem api --method v2/caseAddCaseStatus --data &lt;JSON string or file&gt;
msiem api --method v2/caseAddOrganization --data &lt;JSON string or file&gt;
msiem api --method v2/caseDeleteCaseStatus --data &lt;JSON string or file&gt;
msiem api --method v2/caseEditCase --data &lt;JSON string or file&gt;
msiem api --method v2/caseEditCaseStatus --data &lt;JSON string or file&gt;
msiem api --method v2/caseEditOrganization --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetCaseDetail --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetCaseEventsDetail --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetCaseList --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetCaseStatusList --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetCaseUsers --data &lt;JSON string or file&gt;
msiem api --method v2/caseGetOrganizationList --data &lt;JSON string or file&gt;
msiem api --method v2/devGetDeviceList --data &lt;JSON string or file&gt;
msiem api --method v2/dsAddDataSourceClients --data &lt;JSON string or file&gt;
msiem api --method v2/dsAddDataSourceClientsStatus --data &lt;JSON string or file&gt;
msiem api --method v2/dsAddDataSources --data &lt;JSON string or file&gt;
msiem api --method v2/dsAddDataSourcesStatus --data &lt;JSON string or file&gt;
msiem api --method v2/dsDeleteDataSourceClients --data &lt;JSON string or file&gt;
msiem api --method v2/dsDeleteDataSources --data &lt;JSON string or file&gt;
msiem api --method v2/dsEditDataSource --data &lt;JSON string or file&gt;
msiem api --method v2/dsEditDataSourceClient --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetDataSourceClients --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetDataSourceDetail --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetDataSourceList --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetDataSourceTypes --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetEpoList --data &lt;JSON string or file&gt;
msiem api --method v2/dsGetUserDefinedDataSources --data &lt;JSON string or file&gt;
msiem api --method v2/dsSetUserDefinedDataSources --data &lt;JSON string or file&gt;
msiem api --method v2/dsWriteThirdpartyConfig --data &lt;JSON string or file&gt;
msiem api --method v2/essmgtGetBuildStamp --data &lt;JSON string or file&gt;
msiem api --method v2/essmgtGetESSTime --data &lt;JSON string or file&gt;
msiem api --method v2/geoGetGeoLocRegionList --data &lt;JSON string or file&gt;
msiem api --method v2/geoGetGeoLocs --data &lt;JSON string or file&gt;
msiem api --method v2/getActiveResponseCollectors --data &lt;JSON string or file&gt;
msiem api --method v2/grpGetDeviceTree --data &lt;JSON string or file&gt;
msiem api --method v2/grpGetDeviceTreeEx --data &lt;JSON string or file&gt;
msiem api --method v2/ipsGetAlertData --data &lt;JSON string or file&gt;
msiem api --method v2/ipsGetCorrRawEvents --data &lt;JSON string or file&gt;
msiem api --method v2/miscJobStatus --data &lt;JSON string or file&gt;
msiem api --method v2/miscKeepAlive --data &lt;JSON string or file&gt;
msiem api --method v2/notifyGetTriggeredNotificationDetail --data &lt;JSON string or file&gt;
msiem api --method v2/plcyGetPolicyList --data &lt;JSON string or file&gt;
msiem api --method v2/plcyGetVariableList --data &lt;JSON string or file&gt;
msiem api --method v2/plcyRollPolicy --data &lt;JSON string or file&gt;
msiem api --method v2/qryClose --data &lt;JSON string or file&gt;
msiem api --method v2/qryExecute --data &lt;JSON string or file&gt;
msiem api --method v2/qryExecuteDetail --data &lt;JSON string or file&gt;
msiem api --method v2/qryExecuteGrouped --data &lt;JSON string or file&gt;
msiem api --method v2/qryGetCorrEventDataForID --data &lt;JSON string or file&gt;
msiem api --method v2/qryGetFilterFields --data &lt;JSON string or file&gt;
msiem api --method v2/qryGetResults --data &lt;JSON string or file&gt;
msiem api --method v2/qryGetSelectFields --data &lt;JSON string or file&gt;
msiem api --method v2/qryGetStatus --data &lt;JSON string or file&gt;
msiem api --method v2/runActiveResponseSearch --data &lt;JSON string or file&gt;
msiem api --method v2/sysAddWatchlist --data &lt;JSON string or file&gt;
msiem api --method v2/sysAddWatchlistValues --data &lt;JSON string or file&gt;
msiem api --method v2/sysEditWatchlist --data &lt;JSON string or file&gt;
msiem api --method v2/sysGetWatchlistDetails --data &lt;JSON string or file&gt;
msiem api --method v2/sysGetWatchlistFields --data &lt;JSON string or file&gt;
msiem api --method v2/sysGetWatchlistValues --data &lt;JSON string or file&gt;
msiem api --method v2/sysGetWatchlists --data &lt;JSON string or file&gt;
msiem api --method v2/sysRemoveWatchlist --data &lt;JSON string or file&gt;
msiem api --method v2/sysRemoveWatchlistValues --data &lt;JSON string or file&gt;
msiem api --method v2/userAddAccessGroup --data &lt;JSON string or file&gt;
msiem api --method v2/userAddUser --data &lt;JSON string or file&gt;
msiem api --method v2/userCaseList --data &lt;JSON string or file&gt;
msiem api --method v2/userDeleteAccessGroup --data &lt;JSON string or file&gt;
msiem api --method v2/userDeleteUser --data &lt;JSON string or file&gt;
msiem api --method v2/userEditAccessGroup --data &lt;JSON string or file&gt;
msiem api --method v2/userEditUser --data &lt;JSON string or file&gt;
msiem api --method v2/userGetAccessGroupDetail --data &lt;JSON string or file&gt;
msiem api --method v2/userGetAccessGroupList --data &lt;JSON string or file&gt;
msiem api --method v2/userGetRightsList --data &lt;JSON string or file&gt;
msiem api --method v2/userGetTimeZones --data &lt;JSON string or file&gt;
msiem api --method v2/userGetUserList --data &lt;JSON string or file&gt;
msiem api --method v2/userGetUserRights --data &lt;JSON string or file&gt;
msiem api --method v2/zoneAddSubZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneAddZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneDeleteSubZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneDeleteZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneEditSubZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneEditZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneGetSubZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneGetZone --data &lt;JSON string or file&gt;
msiem api --method v2/zoneGetZoneTree --data &lt;JSON string or file&gt;

Requests with API parameters interpolation
msiem api --method 'login' --args username=&lt;value&gt; password=&lt;value&gt; # Call login  
msiem api --method 'get_devtree'  # Call GRP_GETVIRTUALGROUPIPSLISTDATA  
msiem api --method 'get_zones_devtree'  # Call GRP_GETVIRTUALGROUPIPSLISTDATA  
msiem api --method 'req_client_str' --args ds_id=&lt;value&gt; # Call DS_GETDSCLIENTLIST  
msiem api --method 'get_rfile' --args ftoken=&lt;value&gt; # Call MISC_READFILE  
msiem api --method 'del_rfile' --args ftoken=&lt;value&gt; # Call ESSMGT_DELETEFILE  
msiem api --method 'get_rfile2' --args ftoken=&lt;value&gt; pos=&lt;value&gt; nbytes=&lt;value&gt; # Call MISC_READFILE  
msiem api --method 'get_wfile' --args ds_id=&lt;value&gt; # Call MISC_WRITEFILE  
msiem api --method 'get_rule_history'  # Call PLCY_GETRULECHANGEINFO  
msiem api --method 'add_ds_11_1_3' --args parent_id=&lt;value&gt; name=&lt;value&gt; ds_ip=&lt;value&gt; type_id=&lt;value&gt; zone_id=&lt;value&gt; enabled=&lt;value&gt; url=&lt;value&gt; ds_id=&lt;value&gt; child_enabled=&lt;value&gt; child_count=&lt;value&gt; child_type=&lt;value&gt; idm_id=&lt;value&gt; parameters=&lt;value&gt; # Call dsAddDataSource  
msiem api --method 'add_ds_11_2_1' --args parent_id=&lt;value&gt; name=&lt;value&gt; ds_ip=&lt;value&gt; type_id=&lt;value&gt; zone_id=&lt;value&gt; enabled=&lt;value&gt; url=&lt;value&gt; parameters=&lt;value&gt; # Call dsAddDataSources  
msiem api --method 'add_client1' --args parent_id=&lt;value&gt; name=&lt;value&gt; enabled=&lt;value&gt; ds_ip=&lt;value&gt; hostname=&lt;value&gt; type_id=&lt;value&gt; tz_id=&lt;value&gt; dorder=&lt;value&gt; maskflag=&lt;value&gt; port=&lt;value&gt; require_tls=&lt;value&gt; # Call DS_ADDDSCLIENT  
msiem api --method 'get_recs'  # Call devGetDeviceList  
msiem api --method 'get_dstypes' --args rec_id=&lt;value&gt; # Call dsGetDataSourceTypes  
msiem api --method 'del_ds1' --args parent_id=&lt;value&gt; ds_id=&lt;value&gt; # Call dsDeleteDataSource  
msiem api --method 'del_ds2' --args parent_id=&lt;value&gt; ds_id=&lt;value&gt; # Call dsDeleteDataSources  
msiem api --method 'del_client' --args parent_id=&lt;value&gt; ftoken=&lt;value&gt; # Call DS_DELETEDSCLIENTS  
msiem api --method 'get_job_status' --args job_id=&lt;value&gt; # Call MISC_JOBSTATUS  
msiem api --method 'ds_last_times'  # Call QRY_GETDEVICELASTALERTTIME  
msiem api --method 'zonetree'  # Call zoneGetZoneTree  
msiem api --method 'ds_by_type'  # Call QRY_GETDEVICECOUNTBYTYPE  
msiem api --method 'ds_details1' --args ds_id=&lt;value&gt; # Call dsGetDataSourceDetail  
msiem api --method 'ds_details2' --args ds_id=&lt;value&gt; # Call dsGetDataSourceDetail  
msiem api --method 'get_alarms_custom_time' --args time_range=&lt;value&gt; start_time=&lt;value&gt; end_time=&lt;value&gt; status=&lt;value&gt; page_size=&lt;value&gt; page_number=&lt;value&gt; # Call alarmGetTriggeredAlarms  
msiem api --method 'get_alarms' --args time_range=&lt;value&gt; status=&lt;value&gt; page_size=&lt;value&gt; page_number=&lt;value&gt; # Call alarmGetTriggeredAlarms  
msiem api --method 'get_notification_detail' --args id=&lt;value&gt; # Call notifyGetTriggeredNotificationDetail  
msiem api --method 'get_alarm_details' --args id=&lt;value&gt; # Call notifyGetTriggeredNotification  
msiem api --method 'get_alarm_details_int' --args id=&lt;value&gt; # Call NOTIFY_GETTRIGGEREDNOTIFICATIONDETAIL  
msiem api --method 'ack_alarms' --args ids=&lt;value&gt; # Call alarmAcknowledgeTriggeredAlarm  
msiem api --method 'ack_alarms_11_2_1' --args ids=&lt;value&gt; # Call alarmAcknowledgeTriggeredAlarm  
msiem api --method 'unack_alarms' --args ids=&lt;value&gt; # Call alarmUnacknowledgeTriggeredAlarm  
msiem api --method 'unack_alarms_11_2_1' --args ids=&lt;value&gt; # Call alarmUnacknowledgeTriggeredAlarm  
msiem api --method 'delete_alarms' --args ids=&lt;value&gt; # Call alarmDeleteTriggeredAlarm  
msiem api --method 'delete_alarms_11_2_1' --args ids=&lt;value&gt; # Call alarmDeleteTriggeredAlarm  
msiem api --method 'get_alerts_now' --args ds_id=&lt;value&gt; # Call IPS_GETALERTSNOW  
msiem api --method 'get_flows_now' --args ds_id=&lt;value&gt; # Call IPS_GETFLOWSNOW  
msiem api --method 'get_possible_filters'  # Call v2/qryGetFilterFields  
msiem api --method 'get_possible_fields' --args type=&lt;value&gt; groupType=&lt;value&gt; # Call v2/qryGetSelectFields  
msiem api --method 'event_query_custom_time' --args time_range=&lt;value&gt; start_time=&lt;value&gt; end_time=&lt;value&gt; fields=&lt;value&gt; filters=&lt;value&gt; limit=&lt;value&gt; offset=&lt;value&gt; order_field=&lt;value&gt; order_direction=&lt;value&gt; # Call v2/qryExecuteDetail  
msiem api --method 'event_query' --args time_range=&lt;value&gt; fields=&lt;value&gt; filters=&lt;value&gt; limit=&lt;value&gt; offset=&lt;value&gt; order_field=&lt;value&gt; order_direction=&lt;value&gt; # Call v2/qryExecuteDetail  
msiem api --method 'query_status' --args resultID=&lt;value&gt; # Call v2/qryGetStatus  
msiem api --method 'query_result' --args startPos=&lt;value&gt; numRows=&lt;value&gt; resultID=&lt;value&gt; # Call v2/qryGetResults  
msiem api --method 'grouped_event_query' --args filters=&lt;value&gt; field=&lt;value&gt; time_range=&lt;value&gt; # Call v2/qryExecuteGrouped  
msiem api --method 'grouped_event_query_custom_time' --args filters=&lt;value&gt; field=&lt;value&gt; time_range=&lt;value&gt; start_time=&lt;value&gt; end_time=&lt;value&gt; # Call v2/qryExecuteGrouped  
msiem api --method 'close_query' --args resultID=&lt;value&gt; # Call v2/qryClose  
msiem api --method 'get_alert_data' --args id=&lt;value&gt; # Call ipsGetAlertData  
msiem api --method 'add_note_to_event' --args id=&lt;value&gt; note=&lt;value&gt; # Call ipsAddAlertNote  
msiem api --method 'add_note_to_event_int' --args id=&lt;value&gt; note=&lt;value&gt; # Call IPS_ADDALERTNOTE  
msiem api --method 'get_wl_types'  # Call sysGetWatchlistFields  
msiem api --method 'get_watchlists_no_filters' --args hidden=&lt;value&gt; dynamic=&lt;value&gt; writeOnly=&lt;value&gt; indexedOnly=&lt;value&gt; # Call sysGetWatchlists  
msiem api --method 'get_watchlist_details' --args id=&lt;value&gt; # Call sysGetWatchlistDetails  
msiem api --method 'add_watchlist' --args name=&lt;value&gt; wl_type=&lt;value&gt; # Call sysAddWatchlist  
msiem api --method 'add_watchlist_values' --args watchlist=&lt;value&gt; values=&lt;value&gt; # Call sysAddWatchlistValues  
msiem api --method 'remove_watchlist_values' --args watchlist=&lt;value&gt; values=&lt;value&gt; # Call sysRemoveWatchlistValues  
msiem api --method 'get_watchlist_values' --args id=&lt;value&gt; # Call SYS_GETWATCHLISTDETAILS  
msiem api --method 'remove_watchlists' --args wl_id_list=&lt;value&gt; # Call sysRemoveWatchlist  
msiem api --method 'get_user_locale'  # Call getUserLocale  
msiem api --method 'time_zones'  # Call userGetTimeZones  
msiem api --method 'logout'  # Call logout  
msiem api --method 'get_sys_info'  # Call SYS_GETSYSINFO  
msiem api --method 'get_esm_time'  # Call essmgtGetESSTime  
msiem api --method 'build_stamp'  # Call essmgtGetBuildStamp  

</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>msiem API documentation</title>
<meta name="description" content="Welcome to the **msiem** CLI documentation.
***
Links : [GitHub](https://github.com/mfesiem/msiem), [PyPI](https://pypi.org/project/msiem/), â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/foundation.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<link rel="canonical" href="https://pdoc3.github.io/pdoc/doc/msiem/">
<style>.homelink{display:block;font-size:2em;font-weight:bold;color:#555;padding-bottom:.5em;border-bottom:1px solid silver}.homelink:hover{color:inherit}.homelink img{max-width:20%;max-height:5em;margin:auto;margin-bottom:.3em}</style>
<link rel="icon" href="https://avatars0.githubusercontent.com/u/50667087?s=200&v=4">
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>msiem</code></h1>
</header>
<section id="section-intro">
<p>Welcome to the <strong>msiem</strong> CLI documentation.
</p>
<hr>
<p>Links : <a href="https://github.com/mfesiem/msiem">GitHub</a>, <a href="https://pypi.org/project/msiem/">PyPI</a>, <a href="https://mfesiem.github.io/docs/msiempy/index.html">msiempy documentation</a>, <a href="https://mfesiem.github.io">SIEM API references Home</a> (generated PDFs and other links)</p>
<hr>
<h2 id="cli-overview">CLI overview</h2>
<pre><code>usage: msiem [-h] [-V] {config,alarms,esm,ds,events,api} ...

                _                
  _ __ ___  ___(_) ___ _ __ ___  
 | '_ ` _ \/ __| |/ _ | '_ ` _ \ 
 | | | | | \__ | |  __| | | | | |
 |_| |_| |_|___|_|\___|_| |_| |_| CLI

McAfee SIEM Command Line Interface 0.3.0.dev1
License: MIT
Credits: Andy Walden, Tristan Landes

Run 'msiem &lt;command&gt; --help' for more information about a sub-command.

positional arguments:
  {config,alarms,esm,ds,events,api}
    config              Set and print your msiempy config.
    alarms              Query alarms with alarms and events based regex filters.
                        Print, acknowledge, unacknowledge and delete alarms.
    esm                 Show ESM version and misc informations regarding your ESM.
    ds                  Add datasources from CSV or INI files, list, search, remove.
    events              Query events with any simple filter. Add a note to events.
    api                 Quickly make API requests to any enpoints with any data.

optional arguments:
  -h, --help            show this help message and exit
  -V, --version         Show version and exit (default: False)
</code></pre>
<h2 id="config">Config</h2>
<pre><code>usage: msiem config [-h] [--print] [--set '&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;']
                    ['&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ...]]

    Set and print your msiempy config.  


optional arguments:
  -h, --help            show this help message and exit
  --print               Print configuration fields, password base 64 included.
                        (default: False)
  --set '&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ['&lt;section&gt;' ['&lt;option&gt;' '&lt;value&gt;'] ...]
                        Set the config option to the specified value if passed (can
                        be repeated), OR inveractively prompt for specified
                        configuration section: 'esm' or 'general'. (default: [])
</code></pre>
<h2 id="alarms">Alarms</h2>
<pre><code>usage: msiem alarms [-h] [--action action] [--force] [--time_range time_range]
                    [--start_time time] [--end_time time] [--status status]
                    [--filters '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...]]
                    [--event_filters '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...]]
                    [--alarms_fields list of fields [list of fields ...]]
                    [--events_fields list of fields [list of fields ...]]
                    [--json] [--page_size page_size] [--pages pages]
                    [--workers workers] [--no_events] [--query_events]

Query alarms with alarms and events based regex filters.  
Print, acknowledge, unacknowledge and delete alarms.  

Exemples:  

Acknowledges the (unacknowledged) alarms triggered in the last 
3 days that mention &quot;HTTP: SQL Injection Attempt Detected&quot; in 
the triggered event name and destinated to 10.55.16.99 :
</code></pre>
<p>$ msiem alarms &ndash;action acknowledge -t LAST_24_HOURS &ndash;status unacknowledged &ndash;filters
"ruleName=HTTP: SQL Injection Attempt Detected"
"destIp=10.55.16.99"</p>
<pre><code>
Prints the alarms triggered in the last hour using the query 
module to retreive events informations and request for 
specific fields :
</code></pre>
<p>$ msiem alarms -t LAST_HOUR &ndash;query_events &ndash;alarms_fields acknowledgedDate alarmName events &ndash;events_fields Alert.LastTime Rule.msg Alert.DstIP</p>
<pre><code>
optional arguments:
  -h, --help            show this help message and exit
  --action action       What to do with the alarms, if not specified will print
                        only. Chose from 'acknowledge','unacknowledge','delete'
                        (default: None)
  --force               Will not prompt for confirmation to do the specified action
                        (default: False)
  --time_range time_range, -t time_range
                        Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES,
                        LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY,
                        LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK,
                        PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH,
                        CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR,
                        PREVIOUS_YEAR (default: CURRENT_DAY)
  --start_time time, --t1 time
                        Start trigger date (default: None)
  --end_time time, --t2 time
                        End trigger date (default: None)
  --status status       Status of the alarm. Chose from
                        'acknowledged','unacknowledged','all' (default: all)
  --filters '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...], -f '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...]
                        List of alarm related field/matchvalue filters. Repeatable.
                        Alarm related fields can be : id, summary, assignee,
                        severity, triggeredDate, acknowledgedDate,
                        acknowledgedUsername, alarmName, events, and others
                        (default: [[]])
  --event_filters '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...], -e '&lt;field&gt;=&lt;match&gt;' ['&lt;field&gt;=&lt;match&gt;' ...]
                        List of triggering event related field/matchvalue filters.
                        Repeatable. Event related fields can be : ruleName, srcIp,
                        destIp, protocol, lastTime, subtype, destPort, destMac,
                        srcMac, srcPort, deviceName, sigId, normId, srcUser,
                        destUser, normMessage, normDesc, host, domain, ipsId, etc...
                        Or (if --query_events) : Rule.msg, Alert.SrcPort,
                        Alert.DstPort, Alert.SrcIP, Alert.DstIP, Alert.SrcMac,
                        Alert.DstMac, Alert.LastTime, Rule.NormID, Alert.DSIDSigID,
                        Alert.IPSIDAlertID, etc... (default: [[]])
  --alarms_fields list of fields [list of fields ...]
                        List of fields that appear in the alarm table. Overwritten
                        by --json (default: ['alarmName', 'triggeredDate',
                        'acknowledgedDate', 'events'])
  --events_fields list of fields [list of fields ...]
                        List of fields that appear in the events sub tables. Default
                        value: ['ruleName', 'srcIp', 'destIp']. If you use
                        --query_events, this list will be used to query needed
                        values, you must specify all fields you want to filter on
                        with ewvent_filters. Default value if --query_events:
                        ['Rule.msg', 'Alert.SrcIP', 'Alert.DstIP']. Overwritten by
                        --json. (default: None)
  --json                Prints the raw json object with all loaded fields (default:
                        False)
  --page_size page_size, -p page_size
                        Size of requests (default: 500)
  --pages pages, -n pages
                        Number of alarm pages to load (default: 1)
  --workers workers     Number of max asynch workers (default: 10)
  --no_events           Do not load the complete trigerring events informations.
                        (default: False)
  --query_events        Use the query module to retreive events, much more effcient.
                        Event keys will be like 'Alert.SrcIP' instead of 'srcIp'
                        (default: False)
</code></pre>
<h2 id="esm">ESM</h2>
<pre><code>usage: msiem esm [-h] [--version] [--time] [--disks] [--ram] [--callhome]
                 [--status] [--timezones]

Show ESM version and misc informations regarding your ESM.

optional arguments:
  -h, --help   show this help message and exit
  --version    Show ESM version (default: False)
  --time       time (GMT) (default: False)
  --disks      disk status (default: False)
  --ram        ram status (default: False)
  --callhome   True/False if callhome is active/not active (default: False)
  --status     Statuses and a few other less interesting details :
               autoBackupEnabled, autoBackupDay, backupLastTime,
               backupNextTime, rulesAndSoftwareCheckEnabled,
               rulesAndSoftLastCheck, rulesAndSoftNextCheck (default:
               False)
  --timezones  Current ESM timezone (default: False)
</code></pre>
<h2 id="datasources">Datasources</h2>
<pre><code>usage: msiem ds [-h] [-a &lt;file or folder&gt;] [-s [term]] [-l]
                [--delete &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--deleteclients &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--force]

Add datasources from CSV or INI files, list, search, remove.  

INI format: Single datasource per file.  

</code></pre>
<p>[datasource]</p>
<h1 id="name-of-datasource-req">name of datasource (req)</h1>
<p>name=testing_datasource</p>
<h1 id="ip-of-datasource-ip-or-hostname-required">ip of datasource (ip or hostname required)</h1>
<p>ds_ip=10.10.1.34</p>
<h1 id="hostname-of-te-new-datasource">hostname of te new datasource</h1>
<p>hostname=</p>
<h1 id="type-of-datasource-req">type of datasource (req)</h1>
<p>type_id=65</p>
<h1 id="id-of-parent-device-req">id of parent device (req)</h1>
<p>parent_id=144116287587483648</p>
<h1 id="true-value-designate-a-client-datasource">True value designate a client datasource</h1>
<p>client=</p>
<pre><code>
CSV Format: Multiple datasources per file

</code></pre>
<p>name,ds_ip,hostname,type_id,parent_id,client
Test DataSource 11,10.10.1.41,datasource11.domain.com,65,144116287587483648,
Test DataSource 12,10.10.1.42,datasource12.domain.com,65,144116287587483648,
Test DataSource 13,10.10.1.43,datasource13.domain.com,65,144116287587483648,</p>
<pre><code>
Add Datasources with: 

</code></pre>
<p>msiem ds &ndash;add <file or folder></p>
<pre><code>
optional arguments:
  -h, --help            show this help message and exit
  -a &lt;file or folder&gt;, --add &lt;file or folder&gt;
                        Scan a directory or a file for new Datasource files and add
                        them to the ESM. Datasources can be defined in CSV or INI
                        format (see README.md). (default: None)
  -s [term], --search [term]
                        Search for datasource name, hostname, or IP.May require
                        quotes around the name if thereare spaces. (default: None)
  -l, --list            Display datasources. (default: False)
  --delete &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]
                        Deletes the datasource and all the data. Be careful.
                        (default: None)
  --deleteclients &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]
                        Deletes the datasource's clients and all the data. Be
                        careful. (default: None)
  --force               Do not ask the user input before deletion of the datasources
                        / datasources client. (default: False)
</code></pre>
<h2 id="events">Events</h2>
<pre><code>usage: msiem events [-h] [--time_range time_range] [--start_time time]
                    [--end_time time] [--filters &lt;filter&gt; [&lt;filter&gt; ...]]
                    [--fields list of fields [list of fields ...]] [--json]
                    [--limit limit]

Query events with filters, add note to events.  

With simpler filter
</code></pre>
<p>msiem events &ndash;filter DstIP=127.0.0.1 &ndash;field SrcIP DstIP
</p>
<pre><code>
Specific operatior and multiple values filter
</code></pre>
<p>msiem events &ndash;filter
SrcIP IN 22.0.0.0/8 10.0.0.0/8
&ndash;fields SrcIP DstIP</p>
<pre><code>
optional arguments:
  -h, --help            show this help message and exit
  --time_range time_range, -t time_range
                        Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES,
                        LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY,
                        LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK,
                        PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH,
                        CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR,
                        PREVIOUS_YEAR (default: CURRENT_DAY)
  --start_time time, --t1 time
                        Start trigger date (default: None)
  --end_time time, --t2 time
                        End trigger date (default: None)
  --filters &lt;filter&gt; [&lt;filter&gt; ...], -f &lt;filter&gt; [&lt;filter&gt; ...]
                        List of Event field/value filters: '&lt;field&gt;=&lt;value&gt;' or
                        '&lt;field&gt;' '&lt;operator&gt;' '&lt;value1&gt;' '&lt;value2&gt;...'. Repeatable.
                        Will generate only EsmBasicValue filters. Filter fields can
                        be: Rule.msg, Alert.SrcPort, Alert.DstPort, Alert.SrcIP,
                        Alert.DstIP, Alert.SrcMac, Alert.DstMac, Alert.LastTime,
                        Rule.NormID, Alert.DSIDSigID, Alert.IPSIDAlertID, etc...
                        (default: [[]])
  --fields list of fields [list of fields ...]
                        List of fields that appear in the events table. Default
                        value: ['Rule.msg', 'Alert.SrcIP', 'Alert.DstIP']. (default:
                        None)
  --json                Prints the raw json object with all loaded fields (default:
                        False)
  --limit limit         Size of requests (default: 500)
</code></pre>
<h2 id="api">API</h2>
<pre><code>usage: msiem api [-h] [-m &lt;method&gt;] [-d &lt;JSON string or file&gt;]
                 [-a &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]] [-l]

Quickly make API requests to any enpoints with any data.  

Exemple

</code></pre>
<p>msiem api &ndash;method
"v2/alarmGetTriggeredAlarms?triggeredTimeRange=LAST_24_HOURS&amp;status=&amp;pageSize=500&amp;pageNumber=1"
&ndash;data {}</p>
<pre><code>
optional arguments:
  -h, --help            show this help message and exit
  -m &lt;method&gt;, --method &lt;method&gt;
                        SIEM API method name or NitroSession.PARAMS keyword.
                        Exemple: 'v2/qryGetSelectFields' or 'get_possible_fields',
                        see https://mfesiem.github.io/docs/msiempy/core/session.html
                        . (default: None)
  -d &lt;JSON string or file&gt;, --data &lt;JSON string or file&gt;
                        POST data, in the case of a API method name call. (default:
                        {})
  -a &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...], --args &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]
                        NitroSession.PARAMS interpolation parameters, in the case of
                        a NitroSession.PARAMS keyword call. (default: [[]])
  -l, --list            List all supported SIEM API calls with keywords and
                        parameter mapping. Note that you can still request any
                        endpoint without paramater mapping. (default: False)
</code></pre>
<h2 id="watchlists">Watchlists</h2>
<pre><code></code></pre>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiem/blob/09f2b0cc30d9aadcb9e029f7d19f571a7adde83b/msiem/__init__.py#L0-L318" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Welcome to the **msiem** CLI documentation.  
***
Links : [GitHub](https://github.com/mfesiem/msiem), [PyPI](https://pypi.org/project/msiem/), [msiempy documentation](https://mfesiem.github.io/docs/msiempy/index.html), [SIEM API references Home](https://mfesiem.github.io) (generated PDFs and other links)
***
## CLI overview
```
usage: msiem [-h] [-V] {config,alarms,esm,ds,events,api} ...

                _                
  _ __ ___  ___(_) ___ _ __ ___  
 | &#39;_ ` _ \/ __| |/ _ | &#39;_ ` _ \ 
 | | | | | \__ | |  __| | | | | |
 |_| |_| |_|___|_|\___|_| |_| |_| CLI
     
McAfee SIEM Command Line Interface 0.3.0.dev1
License: MIT
Credits: Andy Walden, Tristan Landes

Run &#39;msiem &lt;command&gt; --help&#39; for more information about a sub-command.

positional arguments:
  {config,alarms,esm,ds,events,api}
    config              Set and print your msiempy config.
    alarms              Query alarms with alarms and events based regex filters.
                        Print, acknowledge, unacknowledge and delete alarms.
    esm                 Show ESM version and misc informations regarding your ESM.
    ds                  Add datasources from CSV or INI files, list, search, remove.
    events              Query events with any simple filter. Add a note to events.
    api                 Quickly make API requests to any enpoints with any data.

optional arguments:
  -h, --help            show this help message and exit
  -V, --version         Show version and exit (default: False)
```
## Config
```
usage: msiem config [-h] [--print] [--set &#39;&lt;section&gt;&#39; [&#39;&lt;option&gt;&#39; &#39;&lt;value&gt;&#39;]
                    [&#39;&lt;section&gt;&#39; [&#39;&lt;option&gt;&#39; &#39;&lt;value&gt;&#39;] ...]]

    Set and print your msiempy config.  
    

optional arguments:
  -h, --help            show this help message and exit
  --print               Print configuration fields, password base 64 included.
                        (default: False)
  --set &#39;&lt;section&gt;&#39; [&#39;&lt;option&gt;&#39; &#39;&lt;value&gt;&#39;] [&#39;&lt;section&gt;&#39; [&#39;&lt;option&gt;&#39; &#39;&lt;value&gt;&#39;] ...]
                        Set the config option to the specified value if passed (can
                        be repeated), OR inveractively prompt for specified
                        configuration section: &#39;esm&#39; or &#39;general&#39;. (default: [])
```
## Alarms
```
usage: msiem alarms [-h] [--action action] [--force] [--time_range time_range]
                    [--start_time time] [--end_time time] [--status status]
                    [--filters &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...]]
                    [--event_filters &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...]]
                    [--alarms_fields list of fields [list of fields ...]]
                    [--events_fields list of fields [list of fields ...]]
                    [--json] [--page_size page_size] [--pages pages]
                    [--workers workers] [--no_events] [--query_events]

Query alarms with alarms and events based regex filters.  
Print, acknowledge, unacknowledge and delete alarms.  

Exemples:  

Acknowledges the (unacknowledged) alarms triggered in the last 
3 days that mention &#34;HTTP: SQL Injection Attempt Detected&#34; in 
the triggered event name and destinated to 10.55.16.99 :
```
$ msiem alarms --action acknowledge \
-t LAST_24_HOURS \
--status unacknowledged \
--filters \
    &#34;ruleName=HTTP: SQL Injection Attempt Detected&#34; \
    &#34;destIp=10.55.16.99&#34;
```

Prints the alarms triggered in the last hour using the query 
module to retreive events informations and request for 
specific fields :
```
$ msiem alarms -t LAST_HOUR \
--query_events \
--alarms_fields acknowledgedDate alarmName events \
--events_fields Alert.LastTime Rule.msg Alert.DstIP
```

optional arguments:
  -h, --help            show this help message and exit
  --action action       What to do with the alarms, if not specified will print
                        only. Chose from &#39;acknowledge&#39;,&#39;unacknowledge&#39;,&#39;delete&#39;
                        (default: None)
  --force               Will not prompt for confirmation to do the specified action
                        (default: False)
  --time_range time_range, -t time_range
                        Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES,
                        LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY,
                        LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK,
                        PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH,
                        CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR,
                        PREVIOUS_YEAR (default: CURRENT_DAY)
  --start_time time, --t1 time
                        Start trigger date (default: None)
  --end_time time, --t2 time
                        End trigger date (default: None)
  --status status       Status of the alarm. Chose from
                        &#39;acknowledged&#39;,&#39;unacknowledged&#39;,&#39;all&#39; (default: all)
  --filters &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...], -f &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...]
                        List of alarm related field/matchvalue filters. Repeatable.
                        Alarm related fields can be : id, summary, assignee,
                        severity, triggeredDate, acknowledgedDate,
                        acknowledgedUsername, alarmName, events, and others
                        (default: [[]])
  --event_filters &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...], -e &#39;&lt;field&gt;=&lt;match&gt;&#39; [&#39;&lt;field&gt;=&lt;match&gt;&#39; ...]
                        List of triggering event related field/matchvalue filters.
                        Repeatable. Event related fields can be : ruleName, srcIp,
                        destIp, protocol, lastTime, subtype, destPort, destMac,
                        srcMac, srcPort, deviceName, sigId, normId, srcUser,
                        destUser, normMessage, normDesc, host, domain, ipsId, etc...
                        Or (if --query_events) : Rule.msg, Alert.SrcPort,
                        Alert.DstPort, Alert.SrcIP, Alert.DstIP, Alert.SrcMac,
                        Alert.DstMac, Alert.LastTime, Rule.NormID, Alert.DSIDSigID,
                        Alert.IPSIDAlertID, etc... (default: [[]])
  --alarms_fields list of fields [list of fields ...]
                        List of fields that appear in the alarm table. Overwritten
                        by --json (default: [&#39;alarmName&#39;, &#39;triggeredDate&#39;,
                        &#39;acknowledgedDate&#39;, &#39;events&#39;])
  --events_fields list of fields [list of fields ...]
                        List of fields that appear in the events sub tables. Default
                        value: [&#39;ruleName&#39;, &#39;srcIp&#39;, &#39;destIp&#39;]. If you use
                        --query_events, this list will be used to query needed
                        values, you must specify all fields you want to filter on
                        with ewvent_filters. Default value if --query_events:
                        [&#39;Rule.msg&#39;, &#39;Alert.SrcIP&#39;, &#39;Alert.DstIP&#39;]. Overwritten by
                        --json. (default: None)
  --json                Prints the raw json object with all loaded fields (default:
                        False)
  --page_size page_size, -p page_size
                        Size of requests (default: 500)
  --pages pages, -n pages
                        Number of alarm pages to load (default: 1)
  --workers workers     Number of max asynch workers (default: 10)
  --no_events           Do not load the complete trigerring events informations.
                        (default: False)
  --query_events        Use the query module to retreive events, much more effcient.
                        Event keys will be like &#39;Alert.SrcIP&#39; instead of &#39;srcIp&#39;
                        (default: False)
```
## ESM
```
usage: msiem esm [-h] [--version] [--time] [--disks] [--ram] [--callhome]
                 [--status] [--timezones]

Show ESM version and misc informations regarding your ESM.

optional arguments:
  -h, --help   show this help message and exit
  --version    Show ESM version (default: False)
  --time       time (GMT) (default: False)
  --disks      disk status (default: False)
  --ram        ram status (default: False)
  --callhome   True/False if callhome is active/not active (default: False)
  --status     Statuses and a few other less interesting details :
               autoBackupEnabled, autoBackupDay, backupLastTime,
               backupNextTime, rulesAndSoftwareCheckEnabled,
               rulesAndSoftLastCheck, rulesAndSoftNextCheck (default:
               False)
  --timezones  Current ESM timezone (default: False)
```
## Datasources
```
usage: msiem ds [-h] [-a &lt;file or folder&gt;] [-s [term]] [-l]
                [--delete &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--deleteclients &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]]
                [--force]

Add datasources from CSV or INI files, list, search, remove.  

INI format: Single datasource per file.  

```
[datasource]
# name of datasource (req)
name=testing_datasource
# ip of datasource (ip or hostname required)
ds_ip=10.10.1.34
# hostname of te new datasource
hostname=
# type of datasource (req)
type_id=65
# id of parent device (req)
parent_id=144116287587483648
# True value designate a client datasource 
client=
```

CSV Format: Multiple datasources per file

```
name,ds_ip,hostname,type_id,parent_id,client
Test DataSource 11,10.10.1.41,datasource11.domain.com,65,144116287587483648,
Test DataSource 12,10.10.1.42,datasource12.domain.com,65,144116287587483648,
Test DataSource 13,10.10.1.43,datasource13.domain.com,65,144116287587483648,
```

Add Datasources with: 

```
msiem ds --add &lt;file or folder&gt;
```

optional arguments:
  -h, --help            show this help message and exit
  -a &lt;file or folder&gt;, --add &lt;file or folder&gt;
                        Scan a directory or a file for new Datasource files and add
                        them to the ESM. Datasources can be defined in CSV or INI
                        format (see README.md). (default: None)
  -s [term], --search [term]
                        Search for datasource name, hostname, or IP.May require
                        quotes around the name if thereare spaces. (default: None)
  -l, --list            Display datasources. (default: False)
  --delete &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]
                        Deletes the datasource and all the data. Be careful.
                        (default: None)
  --deleteclients &lt;datasource ID&gt; [&lt;datasource ID&gt; ...]
                        Deletes the datasource&#39;s clients and all the data. Be
                        careful. (default: None)
  --force               Do not ask the user input before deletion of the datasources
                        / datasources client. (default: False)
```
## Events
```
usage: msiem events [-h] [--time_range time_range] [--start_time time]
                    [--end_time time] [--filters &lt;filter&gt; [&lt;filter&gt; ...]]
                    [--fields list of fields [list of fields ...]] [--json]
                    [--limit limit]

Query events with filters, add note to events.  

With simpler filter
```
msiem events --filter DstIP=127.0.0.1 --field SrcIP DstIP   
```

Specific operatior and multiple values filter
```
msiem events --filter \
    SrcIP IN 22.0.0.0/8 10.0.0.0/8 \
    --fields SrcIP DstIP
```

optional arguments:
  -h, --help            show this help message and exit
  --time_range time_range, -t time_range
                        Timerange, choose from CUSTOM, LAST_MINUTE, LAST_10_MINUTES,
                        LAST_30_MINUTES, LAST_HOUR, CURRENT_DAY, PREVIOUS_DAY,
                        LAST_24_HOURS, LAST_2_DAYS, LAST_3_DAYS, CURRENT_WEEK,
                        PREVIOUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH,
                        CURRENT_QUARTER, PREVIOUS_QUARTER, CURRENT_YEAR,
                        PREVIOUS_YEAR (default: CURRENT_DAY)
  --start_time time, --t1 time
                        Start trigger date (default: None)
  --end_time time, --t2 time
                        End trigger date (default: None)
  --filters &lt;filter&gt; [&lt;filter&gt; ...], -f &lt;filter&gt; [&lt;filter&gt; ...]
                        List of Event field/value filters: &#39;&lt;field&gt;=&lt;value&gt;&#39; or
                        &#39;&lt;field&gt;&#39; &#39;&lt;operator&gt;&#39; &#39;&lt;value1&gt;&#39; &#39;&lt;value2&gt;...&#39;. Repeatable.
                        Will generate only EsmBasicValue filters. Filter fields can
                        be: Rule.msg, Alert.SrcPort, Alert.DstPort, Alert.SrcIP,
                        Alert.DstIP, Alert.SrcMac, Alert.DstMac, Alert.LastTime,
                        Rule.NormID, Alert.DSIDSigID, Alert.IPSIDAlertID, etc...
                        (default: [[]])
  --fields list of fields [list of fields ...]
                        List of fields that appear in the events table. Default
                        value: [&#39;Rule.msg&#39;, &#39;Alert.SrcIP&#39;, &#39;Alert.DstIP&#39;]. (default:
                        None)
  --json                Prints the raw json object with all loaded fields (default:
                        False)
  --limit limit         Size of requests (default: 500)
```
## API
```
usage: msiem api [-h] [-m &lt;method&gt;] [-d &lt;JSON string or file&gt;]
                 [-a &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]] [-l]

Quickly make API requests to any enpoints with any data.  

Exemple

```
msiem api --method \
    &#34;v2/alarmGetTriggeredAlarms?triggeredTimeRange=LAST_24_HOURS&amp;status=&amp;pageSize=500&amp;pageNumber=1&#34; \
    --data {}
```

optional arguments:
  -h, --help            show this help message and exit
  -m &lt;method&gt;, --method &lt;method&gt;
                        SIEM API method name or NitroSession.PARAMS keyword.
                        Exemple: &#39;v2/qryGetSelectFields&#39; or &#39;get_possible_fields&#39;,
                        see https://mfesiem.github.io/docs/msiempy/core/session.html
                        . (default: None)
  -d &lt;JSON string or file&gt;, --data &lt;JSON string or file&gt;
                        POST data, in the case of a API method name call. (default:
                        {})
  -a &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...], --args &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]
                        NitroSession.PARAMS interpolation parameters, in the case of
                        a NitroSession.PARAMS keyword call. (default: [[]])
  -l, --list            List all supported SIEM API calls with keywords and
                        parameter mapping. Note that you can still request any
                        endpoint without paramater mapping. (default: False)
```
## Watchlists
```
```
&#34;&#34;&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="McAfee SIEM API Python wrapper" href="https://mfesiem.github.io/docs/msiem/index.html">
<img src="https://avatars0.githubusercontent.com/u/50667087?s=200&v=4" alt=""> &nbsp; msiem CLI
</a>
</header>
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = 'search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#cli-overview">CLI overview</a></li>
<li><a href="#config">Config</a></li>
<li><a href="#alarms">Alarms</a></li>
<li><a href="#esm">ESM</a></li>
<li><a href="#datasources">Datasources</a></li>
<li><a href="#name-of-datasource-req">name of datasource (req)</a></li>
<li><a href="#ip-of-datasource-ip-or-hostname-required">ip of datasource (ip or hostname required)</a></li>
<li><a href="#hostname-of-te-new-datasource">hostname of te new datasource</a></li>
<li><a href="#type-of-datasource-req">type of datasource (req)</a></li>
<li><a href="#id-of-parent-device-req">id of parent device (req)</a></li>
<li><a href="#true-value-designate-a-client-datasource">True value designate a client datasource</a><ul>
<li><a href="#events">Events</a></li>
<li><a href="#api">API</a></li>
<li><a href="#watchlists">Watchlists</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
</ul>
</nav>
</main>
<footer id="footer">
<span>This software is licensed under the <a href="https://github.com/mfesiem/msiem/blob/master/LICENSE">MIT License</a></span>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>
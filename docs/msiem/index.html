msiem(1)                                                              msiem(1)



NNAAMMEE
       msiem

SSYYNNOOPPSSIISS
       mmssiieemm [-h] [-V] {config,alarms,esm,ds,events,api} ...

DDEESSCCRRIIPPTTIIOONN
       McAfee SIEM Command Line Interface 0.3.1

           License: MIT
           Credits: Andy Walden, Tristan Landes

       Run  'msiem <command> --help' for more information about a sub-command.

OOPPTTIIOONNSS
   SSuubb--ccoommmmaannddss
       mmssiieemm _c_o_n_f_i_g
              Set and print your msiempy config.

       mmssiieemm _a_l_a_r_m_s
              Query alarms with alarms and events based regex filters.  Print,
              acknowledge, unacknowledge and delete alarms.

       mmssiieemm _e_s_m
              Show ESM version and misc informations regarding your ESM.

       mmssiieemm _d_s
              Add datasources from CSV or INI files, list, search, remove.

       mmssiieemm _e_v_e_n_t_s
              Query events with any simple filter. Add a note to events.

       mmssiieemm _a_p_i
              Quickly make API requests to any enpoints with any data.

OOPPTTIIOONNSS ''mmssiieemm ccoonnffiigg''
       usage:  msiem  config  [-h]  [--print]  [--set  '<section>' ['<option>'
       '<value>']
                           ['<section>' ['<option>' '<value>'] ...]]

       Set and print your msiempy config.



       ----pprriinntt
              Print configuration fields, password base 64 included.


       ----sseett  '<section>'  ['<option>'  '<value>']  ['<section>'   ['<option>'
       '<value>'] ...]
              Set the config option to the specified value if passed  (can  be
              repeated),  OR  inveractively prompt for specified configuration
              section: 'esm' or 'general'.


OOPPTTIIOONNSS ''mmssiieemm aallaarrmmss''
       usage: msiem alarms  [-h]  [--action  action]  [--force]  [--time_range
       time_range]
                           [--start_time  time]  [--end_time  time]  [--status
       status]
                           [--filters   '<field>=<match>'   ['<field>=<match>'
       ...]]
                           [--event_filters                  '<field>=<match>'
       ['<field>=<match>' ...]]
                           [--alarms_fields list of  fields  [list  of  fields
       ...]]
                           [--events_fields  list  of  fields  [list of fields
       ...]]
                           [--json] [--page_size page_size] [--pages pages]
                           [--workers workers] [--no_events] [--query_events]

       Query alarms with  alarms  and  events  based  regex  filters.   Print,
       acknowledge, unacknowledge and delete alarms.

       Exemples:

       Acknowledges  the  (unacknowledged) alarms triggered in the last 3 days
       that mention "HTTP: SQL Injection Attempt Detected"  in  the  triggered
       event name and destinated to 10.55.16.99 :

               $ msiem alarms --action acknowledge \
               -t LAST_24_HOURS \
               --status unacknowledged \
               --filters \
                   "ruleName=HTTP: SQL Injection Attempt Detected" \
                   "destIp=10.55.16.99"

       Prints  the alarms triggered in the last hour using the query module to
       retreive events informations and request for specific fields :

               $ msiem alarms -t LAST_HOUR \
               --query_events \
               --alarms_fields acknowledgedDate alarmName events \
               --events_fields Alert.LastTime Rule.msg Alert.DstIP



       ----aaccttiioonn action
              What to do with the alarms, if not specified  will  print  only.
              Chose from 'acknowledge','unacknowledge','delete'


       ----ffoorrccee
              Will not prompt for confirmation to do the specified action


       ----ttiimmee__rraannggee time_range, --tt time_range
              Timerange,  choose  from  CUSTOM,  LAST_MINUTE, LAST_10_MINUTES,
              LAST_30_MINUTES,    LAST_HOUR,    CURRENT_DAY,     PREVIOUS_DAY,
              LAST_24_HOURS,  LAST_2_DAYS,  LAST_3_DAYS,  CURRENT_WEEK, PREVI-
              OUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVI-
              OUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR


       ----ssttaarrtt__ttiimmee time, ----tt11 time
              Start trigger date


       ----eenndd__ttiimmee time, ----tt22 time
              End trigger date


       ----ssttaattuuss status
              Status  of  the  alarm.  Chose  from  'acknowledged','unacknowl-
              edged','all'


       ----ffiilltteerrss     '<field>=<match>'     ['<field>=<match>'     ...],     --ff
       '<field>=<match>' ['<field>=<match>' ...]
              List of alarm related field/matchvalue filters. Repeatable.
                  Alarm related fields can be : id, summary, assignee,  sever-
              ity,   triggeredDate,   acknowledgedDate,  acknowledgedUsername,
              alarmName, events, and others


       ----eevveenntt__ffiilltteerrss   '<field>=<match>'   ['<field>=<match>'    ...],    --ee
       '<field>=<match>' ['<field>=<match>' ...]
              List  of  triggering  event  related  field/matchvalue  filters.
              Repeatable.
                  Event  related fields can be : ruleName, srcIp, destIp, pro-
              tocol, lastTime, subtype, destPort,  destMac,  srcMac,  srcPort,
              deviceName,  sigId, normId, srcUser, destUser, normMessage, nor-
              mDesc, host, domain, ipsId, etc...
                  Or (if --query_events) : Rule.msg, Alert.SrcPort, Alert.Dst-
              Port,   Alert.SrcIP,  Alert.DstIP,  Alert.SrcMac,  Alert.DstMac,
              Alert.LastTime, Rule.NormID,  Alert.DSIDSigID,  Alert.IPSIDAler-
              tID, etc...


       ----aallaarrmmss__ffiieellddss list of fields [list of fields ...]
              List  of  fields  that appear in the alarm table. Overwritten by
              --json


       ----eevveennttss__ffiieellddss list of fields [list of fields ...]
              List of fields that appear in the  events  sub  tables.  Default
              value:    ['ruleName',    'srcIp',   'destIp'].   If   you   use
              --query_events, this list will be used to query  needed  values,
              you  must  specify  all  fields  you  want  to  filter  on  with
              ewvent_filters. Default value  if  --query_events:  ['Rule.msg',
              'Alert.SrcIP', 'Alert.DstIP']. Overwritten by --json.


       ----jjssoonn Prints the raw json object with all loaded fields


       ----ppaaggee__ssiizzee page_size, --pp page_size
              Size of requests


       ----ppaaggeess pages, --nn pages
              Number of alarm pages to load


       ----wwoorrkkeerrss workers
              Number of max asynch workers


       ----nnoo__eevveennttss
              Do not load the complete trigerring events informations.


       ----qquueerryy__eevveennttss
              Use  the  query  module  to retreive events, much more effcient.
              Event keys will be like 'Alert.SrcIP' instead of 'srcIp'


OOPPTTIIOONNSS ''mmssiieemm eessmm''
       usage: msiem esm [-h] [--version] [--time] [--disks]  [--ram]  [--call-
       home]
                        [--status] [--timezones]

       Show ESM version and misc informations regarding your ESM.



       ----vveerrssiioonn
              Show ESM version


       ----ttiimmee time (GMT)


       ----ddiisskkss
              disk status


       ----rraamm  ram status


       ----ccaallllhhoommee
              True/False if callhome is active/not active


       ----ssttaattuuss
              Statuses  and  a few other less interesting details : autoBacku-
              pEnabled, autoBackupDay, backupLastTime,  backupNextTime,  rule-
              sAndSoftwareCheckEnabled,  rulesAndSoftLastCheck,  rulesAndSoft-
              NextCheck


       ----ttiimmeezzoonneess
              Current ESM timezone


OOPPTTIIOONNSS ''mmssiieemm ddss''
       usage: msiem ds [-h] [-a <file or folder>] [-s [term]] [-l]
                       [--delete <datasource ID> [<datasource ID> ...]]
                       [--deleteclients <datasource ID> [<datasource ID> ...]]
                       [--force]

       Add datasources from CSV or INI files, list, search, remove.

       INI format: Single datasource per file.


               [datasource]
               # name of datasource (req)
               name=testing_datasource
               # ip of datasource (ip or hostname required)
               ds_ip=10.10.1.34
               # hostname of te new datasource
               hostname=
               # type of datasource (req)
               type_id=65
               # id of parent device (req)
               parent_id=144116287587483648
               # True value designate a client datasource
               client=


       CSV Format: Multiple datasources per file


               name,ds_ip,hostname,type_id,parent_id,client
               Test               DataSource               11,10.10.1.41,data-
       source11.domain.com,65,144116287587483648,
               Test               DataSource               12,10.10.1.42,data-
       source12.domain.com,65,144116287587483648,
               Test               DataSource               13,10.10.1.43,data-
       source13.domain.com,65,144116287587483648,


       Add Datasources with:

               $ msiem ds --add <file or folder>



       --aa <file or folder>, ----aadddd <file or folder>
              Scan a directory or a file for new Datasource files and add them
              to the ESM. Datasources can be defined in CSV or INI format (see
              README.md).


       --ss [term], ----sseeaarrcchh [term]
              Search for datasource name, hostname, or IP.May  require  quotes
              around the name if thereare spaces.


       --ll, ----lliisstt
              Display datasources.


       ----ddeelleettee <datasource ID> [<datasource ID> ...]
              Deletes the datasource and all the data. Be careful.


       ----ddeelleetteecclliieennttss <datasource ID> [<datasource ID> ...]
              Deletes the datasource's clients and all the data. Be careful.


       ----ffoorrccee
              Do  not  ask the user input before deletion of the datasources /
              datasources client.


OOPPTTIIOONNSS ''mmssiieemm eevveennttss''
       usage: msiem events [-h] [--time_range time_range] [--start_time time]
                           [--end_time  time]  [--filters  <filter>  [<filter>
       ...]]
                           [--fields  <field> [<field> ...]] [--json] [--limit
       limit]

       Query events with filters, add note to events.

       With simpler filter:

               $ msiem events --filter DstIP=127.0.0.1 --field SrcIP DstIP


       Specific operatior and multiple values filter:

               $ msiem events --filter \
                   SrcIP IN 22.0.0.0/8 10.0.0.0/8 \
                   --fields SrcIP DstIP



       ----ttiimmee__rraannggee time_range, --tt time_range
              Timerange, choose  from  CUSTOM,  LAST_MINUTE,  LAST_10_MINUTES,
              LAST_30_MINUTES,     LAST_HOUR,    CURRENT_DAY,    PREVIOUS_DAY,
              LAST_24_HOURS, LAST_2_DAYS,  LAST_3_DAYS,  CURRENT_WEEK,  PREVI-
              OUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVI-
              OUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR


       ----ssttaarrtt__ttiimmee time, ----tt11 time
              Start trigger date


       ----eenndd__ttiimmee time, ----tt22 time
              End trigger date


       ----ffiilltteerrss <filter> [<filter> ...], --ff <filter> [<filter> ...]
              List  of  Event  field/value   filters:   '<field>=<value>'   or
              '<field>'  '<operator>'  '<value1>'  '<value2>...'.  Repeatable.
              Will generate only EsmBasicValue filters.
                  Filter fields can be:  Rule.msg,  Alert.SrcPort,  Alert.Dst-
              Port,   Alert.SrcIP,  Alert.DstIP,  Alert.SrcMac,  Alert.DstMac,
              Alert.LastTime, Rule.NormID,  Alert.DSIDSigID,  Alert.IPSIDAler-
              tID, etc...


       ----ffiieellddss <field> [<field> ...]
              List  of  fields that appear in the events table. Default value:
              ['Rule.msg', 'Alert.SrcIP', 'Alert.DstIP'].


       ----jjssoonn Prints the raw json object with all loaded fields


       ----lliimmiitt limit
              Size of requests


OOPPTTIIOONNSS ''mmssiieemm aappii''
       usage: msiem api [-h] [-m <method>] [-d <JSON string or file>]
                        [-a <key>=<value> [<key>=<value> ...]] [-l]

       Quickly make API requests to any enpoints with any data.

       Exemple:

       $ msiem api --method \
           "v2/alarmGetTriggeredAlarms?triggeredTimeRange=LAST_24_HOURS&sta-
       tus=&pageSize=500&pageNumber=1" \
           --data {}



       --mm <method>, ----mmeetthhoodd <method>
              SIEM  API  method  name or NitroSession.PARAMS keyword. Exemple:
              'v2/qryGetSelectFields' or 'get_possible_fields', see --list for
              full details .


       --dd <JSON string or file>, ----ddaattaa <JSON string or file>
              POST data, in the case of a API method name call.


       --aa    <key>=<value>    [<key>=<value>    ...],   ----aarrggss   <key>=<value>
       [<key>=<value> ...]
              NitroSession.PARAMS  interpolation  parameters, in the case of a
              NitroSession.PARAMS keyword call.


       --ll, ----lliisstt
              List all available SIEM API calls, and supported calls with key-
              words and parameter mapping requests.


       --VV, ----vveerrssiioonn
              Show version and exit


AAUUTTHHOORRSS
       mmssiieemm   was   written   by   Andy   Walden,   Tristan  Landes  <<<UNSET
       --author_email OPTION>>>.

DDIISSTTRRIIBBUUTTIIOONN
       The latest version of msiem may be downloaded from



                                    Manual                            msiem(1)

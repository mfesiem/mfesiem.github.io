<code><pre>
msiem(1)							      msiem(1)



NAME
       msiem

SYNOPSIS
       msiem [-h] [-V] {config,alarms,esm,ds,events,api} ...

DESCRIPTION
       McAfee SIEM Command Line Interface 0.3.1

	   License: MIT
	   Credits: Andy Walden, Tristan Landes

       Run  'msiem <command> --help' for more information about a sub-command.

OPTIONS
   Sub-commands
       msiem config
	      Set and print your msiempy config.

       msiem alarms
	      Query alarms with alarms and events based regex filters.	Print,
	      acknowledge, unacknowledge and delete alarms.

       msiem esm
	      Show ESM version and misc informations regarding your ESM.

       msiem ds
	      Add datasources from CSV or INI files, list, search, remove.

       msiem events
	      Query events with any simple filter. Add a note to events.

       msiem api
	      Quickly make API requests to any enpoints with any data.

OPTIONS 'msiem config'
       usage:  msiem  config  [-h]  [--print]  [--set  '<section>' ['<option>'
       '<value>']
			   ['<section>' ['<option>' '<value>'] ...]]

       Set and print your msiempy config.




       --print
	      Print configuration fields, password base 64 included.


       --set  '<section>'  ['<option>'	'<value>']  ['<section>'   ['<option>'
       '<value>'] ...]
	      Set the config option to the specified value if passed  (can  be
	      repeated),  OR  inveractively prompt for specified configuration
	      section: 'esm' or 'general'.


OPTIONS 'msiem alarms'
       usage: msiem alarms  [-h]  [--action  action]  [--force]  [--time_range
       time_range]
			   [--start_time  time]  [--end_time  time]  [--status
       status]
			   [--filters	'<field>=<match>'   ['<field>=<match>'
       ...]]
			   [--event_filters		     '<field>=<match>'
       ['<field>=<match>' ...]]
			   [--alarms_fields list of  fields  [list  of	fields
       ...]]
			   [--events_fields  list  of  fields  [list of fields
       ...]]
			   [--json] [--page_size page_size] [--pages pages]
			   [--workers workers] [--no_events] [--query_events]

       Query alarms with  alarms  and  events  based  regex  filters.	Print,
       acknowledge, unacknowledge and delete alarms.

       Exemples:

       Acknowledges  the  (unacknowledged) alarms triggered in the last 3 days
       that mention "HTTP: SQL Injection Attempt Detected"  in	the  triggered
       event name and destinated to 10.55.16.99 :

	   $ msiem alarms --action acknowledge \
	   -t LAST_24_HOURS \
	   --status unacknowledged \
	   --filters \
	       "ruleName=HTTP: SQL Injection Attempt Detected" \
	       "destIp=10.55.16.99"

       Prints  the alarms triggered in the last hour using the query module to
       retreive events informations and request for specific fields :

	   $ msiem alarms -t LAST_HOUR \
	   --query_events \
	   --alarms_fields acknowledgedDate alarmName events \
	   --events_fields Alert.LastTime Rule.msg Alert.DstIP




       --action action
	      What to do with the alarms, if not specified  will  print  only.
	      Chose from 'acknowledge','unacknowledge','delete'


       --force
	      Will not prompt for confirmation to do the specified action


       --time_range time_range, -t time_range
	      Timerange,  choose  from	CUSTOM,  LAST_MINUTE, LAST_10_MINUTES,
	      LAST_30_MINUTES,	  LAST_HOUR,	CURRENT_DAY,	 PREVIOUS_DAY,
	      LAST_24_HOURS,  LAST_2_DAYS,  LAST_3_DAYS,  CURRENT_WEEK, PREVI-
	      OUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVI-
	      OUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR


       --start_time time, --t1 time
	      Start trigger date


       --end_time time, --t2 time
	      End trigger date


       --status status
	      Status  of  the  alarm.  Chose  from  'acknowledged','unacknowl-
	      edged','all'


       --filters     '<field>=<match>'	   ['<field>=<match>'	  ...],     -f
       '<field>=<match>' ['<field>=<match>' ...]
	      List of alarm related field/matchvalue filters. Repeatable.
		  Alarm related fields can be : id, summary, assignee,	sever-
	      ity,   triggeredDate,   acknowledgedDate,  acknowledgedUsername,
	      alarmName, events, and others


       --event_filters	 '<field>=<match>'   ['<field>=<match>'    ...],    -e
       '<field>=<match>' ['<field>=<match>' ...]
	      List  of	triggering  event  related  field/matchvalue  filters.
	      Repeatable.
		  Event  related fields can be : ruleName, srcIp, destIp, pro-
	      tocol, lastTime, subtype, destPort,  destMac,  srcMac,  srcPort,
	      deviceName,  sigId, normId, srcUser, destUser, normMessage, nor-
	      mDesc, host, domain, ipsId, etc...
		  Or (if --query_events) : Rule.msg, Alert.SrcPort, Alert.Dst-
	      Port,   Alert.SrcIP,  Alert.DstIP,  Alert.SrcMac,  Alert.DstMac,
	      Alert.LastTime, Rule.NormID,  Alert.DSIDSigID,  Alert.IPSIDAler-
	      tID, etc...


       --alarms_fields list of fields [list of fields ...]
	      List  of	fields	that appear in the alarm table. Overwritten by
	      --json


       --events_fields list of fields [list of fields ...]
	      List of fields that appear in the  events  sub  tables.  Default
	      value:	['ruleName',	'srcIp',   'destIp'].	If   you   use
	      --query_events, this list will be used to query  needed  values,
	      you  must  specify  all  fields  you  want  to  filter  on  with
	      ewvent_filters. Default value  if  --query_events:  ['Rule.msg',
	      'Alert.SrcIP', 'Alert.DstIP']. Overwritten by --json.


       --json Prints the raw json object with all loaded fields


       --page_size page_size, -p page_size
	      Size of requests


       --pages pages, -n pages
	      Number of alarm pages to load


       --workers workers
	      Number of max asynch workers


       --no_events
	      Do not load the complete trigerring events informations.


       --query_events
	      Use  the	query  module  to retreive events, much more effcient.
	      Event keys will be like 'Alert.SrcIP' instead of 'srcIp'


OPTIONS 'msiem esm'
       usage: msiem esm [-h] [--version] [--time] [--disks]  [--ram]  [--call-
       home]
			[--status] [--timezones]

       Show ESM version and misc informations regarding your ESM.



       --version
	      Show ESM version


       --time time (GMT)


       --disks
	      disk status


       --ram  ram status


       --callhome
	      True/False if callhome is active/not active


       --status
	      Statuses	and  a few other less interesting details : autoBacku-
	      pEnabled, autoBackupDay, backupLastTime,	backupNextTime,  rule-
	      sAndSoftwareCheckEnabled,  rulesAndSoftLastCheck,  rulesAndSoft-
	      NextCheck


       --timezones
	      Current ESM timezone


OPTIONS 'msiem ds'
       usage: msiem ds [-h] [-a <file or folder>] [-s [term]] [-l]
		       [--delete <datasource ID> [<datasource ID> ...]]
		       [--deleteclients <datasource ID> [<datasource ID> ...]]
		       [--force]

       Add datasources from CSV or INI files, list, search, remove.

       INI format: Single datasource per file.


	   [datasource]
	   # name of datasource (req)
	   name=testing_datasource
	   # ip of datasource (ip or hostname required)
	   ds_ip=10.10.1.34
	   # hostname of te new datasource
	   hostname=
	   # type of datasource (req)
	   type_id=65
	   # id of parent device (req)
	   parent_id=144116287587483648
	   # True value designate a client datasource
	   client=


       CSV Format: Multiple datasources per file


	   name,ds_ip,hostname,type_id,parent_id,client
	   Test_ds_1,10.10.1.41,datasource11.domain.com,65,144116287587483648,
	   Test_ds_2,10.10.1.42,datasource12.domain.com,65,144116287587483648,
	   Test_ds_3,10.10.1.43,datasource13.domain.com,65,144116287587483648,


       Add Datasources with:

	       $ msiem ds --add <file or folder>




       -a <file or folder>, --add <file or folder>
	      Scan a directory or a file for new Datasource files and add them
	      to the ESM. Datasources can be defined in CSV or INI format (see
	      README.md).


       -s [term], --search [term]
	      Search for datasource name, hostname, or IP.May  require	quotes
	      around the name if thereare spaces.


       -l, --list
	      Display datasources.


       --delete <datasource ID> [<datasource ID> ...]
	      Deletes the datasource and all the data. Be careful.


       --deleteclients <datasource ID> [<datasource ID> ...]
	      Deletes the datasource's clients and all the data. Be careful.


       --force
	      Do  not  ask the user input before deletion of the datasources /
	      datasources client.


OPTIONS 'msiem events'
       usage: msiem events [-h] [--time_range time_range] [--start_time time]
			   [--end_time	time]  [--filters  <filter>  [<filter>
       ...]]
			   [--fields  <field> [<field> ...]] [--json] [--limit
       limit]

       Query events with filters, add note to events.

       With simpler filter:

	   $ msiem events --filter DstIP=127.0.0.1 --field SrcIP DstIP


       Specific operatior and multiple values filter:

	   $ msiem events --filter \
	       SrcIP IN 22.0.0.0/8 10.0.0.0/8 \
	       --fields SrcIP DstIP




       --time_range time_range, -t time_range
	      Timerange, choose  from  CUSTOM,	LAST_MINUTE,  LAST_10_MINUTES,
	      LAST_30_MINUTES,	   LAST_HOUR,	 CURRENT_DAY,	 PREVIOUS_DAY,
	      LAST_24_HOURS, LAST_2_DAYS,  LAST_3_DAYS,  CURRENT_WEEK,	PREVI-
	      OUS_WEEK, CURRENT_MONTH, PREVIOUS_MONTH, CURRENT_QUARTER, PREVI-
	      OUS_QUARTER, CURRENT_YEAR, PREVIOUS_YEAR


       --start_time time, --t1 time
	      Start trigger date


       --end_time time, --t2 time
	      End trigger date


       --filters <filter> [<filter> ...], -f <filter> [<filter> ...]
	      List  of	Event  field/value   filters:	'<field>=<value>'   or
	      '<field>'  '<operator>'  '<value1>'  '<value2>...'.  Repeatable.
	      Will generate only EsmBasicValue filters.
		  Filter fields can be:  Rule.msg,  Alert.SrcPort,  Alert.Dst-
	      Port,   Alert.SrcIP,  Alert.DstIP,  Alert.SrcMac,  Alert.DstMac,
	      Alert.LastTime, Rule.NormID,  Alert.DSIDSigID,  Alert.IPSIDAler-
	      tID, etc...


       --fields <field> [<field> ...]
	      List  of	fields that appear in the events table. Default value:
	      ['Rule.msg', 'Alert.SrcIP', 'Alert.DstIP'].


       --json Prints the raw json object with all loaded fields


       --limit limit
	      Size of requests


OPTIONS 'msiem api'
       usage: msiem api [-h] [-m <method>] [-d <JSON string or file>]
			[-a <key>=<value> [<key>=<value> ...]] [-l]

       Quickly make API requests to any enpoints with any data.

       Exemple:

       $ msiem api --method \
	   "v2/alarmGetTriggeredAlarms?triggeredTimeRange=LAST_24_HOURS&sta-
       tus=&pageSize=500&pageNumber=1" \
	   --data {}




       -m <method>, --method <method>
	      SIEM  API  method  name or NitroSession.PARAMS keyword. Exemple:
	      'v2/qryGetSelectFields' or 'get_possible_fields', see 'msiem api
	      --list' for full details .


       -d <JSON string or file>, --data <JSON string or file>
	      POST  data, in the case of a API method name call.  See the SIEM
	      API docs for full details.


       -a   <key>=<value>   [<key>=<value>    ...],    --args	 <key>=<value>
       [<key>=<value> ...]
	      Interpolation parameters, in the case of	a  NitroSession.PARAMS
	      keyword call.  See 'msiem api --list' for full details.


       -l, --list
	      List all available SIEM API calls as well as all supported calls
	      with keywords and parameter mapping.


       -V, --version
	      Show version and exit


AUTHORS
       msiem  was  written   by   Andy	 Walden,   Tristan   Landes   <<<UNSET
       --author_email OPTION>>>.

DISTRIBUTION
       The latest version of msiem may be downloaded from



				    Manual			      msiem(1)
</pre></code>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>msiempy.core.utils API documentation</title>
<meta name="description" content="A few quick static util methods." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/foundation.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<link rel="canonical" href="https://pdoc3.github.io/pdoc/doc/msiempy/core/utils.html">
<style>.homelink{display:block;font-size:2em;font-weight:bold;color:#555;padding-bottom:.5em;border-bottom:1px solid silver}.homelink:hover{color:inherit}.homelink img{max-width:20%;max-height:5em;margin:auto;margin-bottom:.3em}</style>
<link rel="icon" href="https://avatars0.githubusercontent.com/u/50667087?s=200&v=4">
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>msiempy.core.utils</code></h1>
</header>
<section id="section-intro">
<p>A few quick static util methods.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L0-L460" class="git-link">Browse git</a>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;A few quick static util methods.
&#34;&#34;&#34;

import base64
import re
from functools import wraps
from datetime import datetime, timedelta
import dateutil.parser

__pdoc__ = {}  # Init pdoc to document dynamically


def dehexify(data):
    &#34;&#34;&#34;
    A URL and Hexadecimal Decoding Library.
    Credit: Larry Dewey. In the case of the SIEM API, this is used only when dealing with the pricate API calls.
    &#34;&#34;&#34;

    hexen = {
        &#34;\x1c&#34;: &#34;,&#34;,  # Replacing Device Control 1 with a comma.
        &#34;\x11&#34;: &#34;\n&#34;,  # Replacing Device Control 2 with a new line.
        &#34;\x12&#34;: &#34; &#34;,  # Space
        &#34;\x22&#34;: &#39;&#34;&#39;,  # Double Quotes
        &#34;\x23&#34;: &#34;#&#34;,  # Number Symbol
        &#34;\x27&#34;: &#34;&#39;&#34;,  # Single Quote
        &#34;\x28&#34;: &#34;(&#34;,  # Open Parenthesis
        &#34;\x29&#34;: &#34;)&#34;,  # Close Parenthesis
        &#34;\x2b&#34;: &#34;+&#34;,  # Plus Symbol
        &#34;\x2d&#34;: &#34;-&#34;,  # Hyphen Symbol
        &#34;\x2e&#34;: &#34;.&#34;,  # Period, dot, or full stop.
        &#34;\x2f&#34;: &#34;/&#34;,  # Forward Slash or divide symbol.
        &#34;\x7c&#34;: &#34;|&#34;,  # Vertical bar or pipe.
    }

    uri = {
        &#34;%11&#34;: &#34;,&#34;,  # Replacing Device Control 1 with a comma.
        &#34;%12&#34;: &#34;\n&#34;,  # Replacing Device Control 2 with a new line.
        &#34;%20&#34;: &#34; &#34;,  # Space
        &#34;%22&#34;: &#39;&#34;&#39;,  # Double Quotes
        &#34;%23&#34;: &#34;#&#34;,  # Number Symbol
        &#34;%27&#34;: &#34;&#39;&#34;,  # Single Quote
        &#34;%28&#34;: &#34;(&#34;,  # Open Parenthesis
        &#34;%29&#34;: &#34;)&#34;,  # Close Parenthesis
        &#34;%2B&#34;: &#34;+&#34;,  # Plus Symbol
        &#34;%2D&#34;: &#34;-&#34;,  # Hyphen Symbol
        &#34;%2E&#34;: &#34;.&#34;,  # Period, dot, or full stop.
        &#34;%2F&#34;: &#34;/&#34;,  # Forward Slash or divide symbol.
        &#34;%3A&#34;: &#34;:&#34;,  # Colon
        &#34;%7C&#34;: &#34;|&#34;,  # Vertical bar or pipe.
    }

    for (enc, dec) in hexen.items():
        data = data.replace(enc, dec)

    for (enc, dec) in uri.items():
        data = data.replace(enc, dec)

    return data


# Unused method
# def timethis(func):
#     &#34;&#34;&#34;
#     Decorator that reports the execution time.
#     &#34;&#34;&#34;
#     @wraps(func)
#     def wrapper(*args, **kwargs):
#         &#34;&#34;&#34;Wrapper&#34;&#34;&#34;
#         start = time.time()
#         result = func(*args, **kwargs)
#         end = time.time()
#         print(func.__name__, end-start)
#         return result
#     return wrapper


def tob64(s):
    &#34;&#34;&#34;
    Encode a string to base64 almost like `echo &#39;123&#39; | base64` would do.
    &#34;&#34;&#34;
    if type(s) is str:
        return base64.b64encode(s.encode(&#34;utf-8&#34;)).decode()


def fromb64(s):
    &#34;&#34;&#34;
    Decode a string to base64 almost like `echo &#39;MTIzCg==&#39; | base64 --decode` would do.
    &#34;&#34;&#34;
    if type(s) is str:
        return base64.b64decode(s.encode(&#34;utf-8&#34;)).encode()


# Usefull to compte CURRENT_WEEK timerange
# one_day = timedelta(days=1)
# def get_week(date):
#     &#34;&#34;&#34;
#     Return the full week (Sunday first) of the week containing the given date.

#         - &#39;date&#39; may be a datetime or date instance (the same type is returned).
#     &#34;&#34;&#34;
#     day_idx = (date.weekday() + 1) % 7  # turn sunday into 0, monday into 1, etc.
#     sunday = date - timedelta(days=day_idx)
#     date = sunday
#     for n in range(7):
#         yield date
#         date += one_day


def timerange_gettimes(time_range):
    &#34;&#34;&#34;
    Convert a string time range to a tuple of datetime objects. Only works for certain time ranges.
    &#34;&#34;&#34;
    t = time_range.upper()
    now = datetime.now()
    times = tuple()

    if t == &#34;LAST_MINUTE&#34;:
        times = (now - timedelta(seconds=60), now)

    elif t == &#34;LAST_10_MINUTES&#34;:
        times = (now - timedelta(minutes=10), now)

    elif t == &#34;LAST_30_MINUTES&#34;:
        times = (now - timedelta(minutes=30), now)

    elif t == &#34;LAST_HOUR&#34;:
        times = (now - timedelta(minutes=60), now)

    elif t == &#34;CURRENT_DAY&#34;:
        times = (
            now.replace(hour=0, minute=0, second=0),
            now.replace(hour=23, minute=59, second=59),
        )

    elif t == &#34;PREVIOUS_DAY&#34;:
        yesterday = now - timedelta(hours=24)
        times = (
            yesterday.replace(hour=0, minute=0, second=0),
            yesterday.replace(hour=23, minute=59, second=59),
        )

    elif t == &#34;LAST_24_HOURS&#34;:
        times = (now - timedelta(hours=24), now)

    elif t == &#34;LAST_2_DAYS&#34;:
        times = (now - timedelta(days=2), now)

    elif t == &#34;LAST_3_DAYS&#34;:
        times = (now - timedelta(days=3), now)
    # TODO Support other time ranges
    # elif t == &#39;CURRENT_WEEK&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_WEEK&#39;:
    #     pass
    # elif t == &#39;CURRENT_MONTH&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_MONTH&#39;:
    #     pass
    # elif t == &#39;CURRENT_QUARTER&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_QUARTER&#39;:
    #     pass
    # elif t == &#39;CURRENT_YEAR&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_YEAR&#39;:
    #     pass
    else:
        raise NotImplementedError(&#34;Timerange &#34; + t + &#34; is not supported yet&#34;)

    return (times[0].isoformat(), times[1].isoformat())


def divide_times(first, last, slots=0, delta=0, time=0):
    &#34;&#34;&#34;
    Divide the time range based on a delta or on a number of slots or another time,.
    Return list of tuple
    &#34;&#34;&#34;

    # parse the dates
    t1 = convert_to_time_obj(first) if not isinstance(first, datetime) else first
    t2 = convert_to_time_obj(last) if not isinstance(last, datetime) else last

    duration = t2 - t1

    if slots == 0:
        if delta == 0:
            if time == 0:
                raise AttributeError(&#34;Either time, slots or delta must be specified&#34;)
            else:
                div = convert_to_time_obj(time) - t1

        elif isinstance(delta, timedelta):
            div = delta
        elif isinstance(delta, str):
            div = parse_timedelta(delta)
        else:
            raise AttributeError(&#34;delta Must be timedelta or str object&#34;)

        slots = int(duration.total_seconds() / div.total_seconds()) + 1

    timeSlot = timedelta(seconds=duration.total_seconds() / slots)

    # print(locals())

    times = list()

    for i in range(slots):
        times.append((t1, t1 + timeSlot))
        t1 += timeSlot

    return times


def regex_match(regex, string):
    &#34;&#34;&#34;
    Return True if the string match the regex.
    &#34;&#34;&#34;
    if re.search(regex, string):
        return True
    else:
        return False


def format_esm_time(esm_time):
    &#34;&#34;&#34;Converts time object to ESM time string.

    Arguments:

    - `time_obj` (`datetime.datetime`)

    Returns: time string in format `2019-04-08T19:35:02.971Z`
    &#34;&#34;&#34;
    _esm_out_time_fmt = &#34;%m/%d/%Y %H:%M:%S&#34;
    _esm_in_time_fmt = &#34;%Y-%m-%dT%H:%M:%S.000Z&#34;
    if isinstance(esm_time, str):
        esm_time = convert_to_time_obj(esm_time)  # , _esm_out_time_fmt)
    return datetime.strftime(esm_time, _esm_in_time_fmt)


def convert_to_time_obj(time_str):
    &#34;&#34;&#34;
    Converts given timestamp string to datetime object

    Args:
        time_str: timestamp in format &#39;YYYY/MM/DD HH:MM:SS&#39;,
                         &#39;MM/DD/YYYY HH:MM:SS&#39;, or &#39;DD/MM/YYYY HH:MM:SS&#39;

    Returns:
        datetime object or None if no format matches
    &#34;&#34;&#34;
    return dateutil.parser.parse(time_str)


def parse_query_result(columns, rows):
    &#34;&#34;&#34;
    For input :

        columns = [{&#39;name&#39;: &#39;Alert.LastTime&#39;}, {&#39;name&#39;: &#39;Rule.msg&#39;}, {&#39;name&#39;: &#39;Alert.DstIP&#39;}, {&#39;name&#39;: &#39;Alert.IPSIDAlertID&#39;}]
        rows =
            [
                {&#39;values&#39;: [&#39;09/22/2020 15:51:14&#39;, &#39;Postfix Disconnect from host&#39;, &#39;::&#39;, &#39;144116287604260864|547123&#39;]},
                {&#39;values&#39;: [&#39;09/22/2020 15:51:14&#39;, &#39;Postfix Lost connection from host&#39;, &#39;::&#39;, &#39;144116287604260864|547122&#39;]}
            }

    Returns :

        [
            {
                &#34;Alert.LastTime&#34;:&#34;09/22/2020 15:51:14&#34;,
                &#34;Rule.msg&#34;:&#34;Postfix Disconnect from host&#34;,
                &#34;Alert.DstIP&#34;:&#34;::&#34;,
                &#34;Alert.IPSIDAlertID&#34;:&#34;144116287604260864|547123&#34;
            },
            {
                ...
            },
        ]

    &#34;&#34;&#34;
    events = list()
    for row in rows:
        event = dict()
        for i in range(len(columns)):
            event.update({columns[i][&#34;name&#34;]: row[&#34;values&#34;][i]})

        events.append(event)

    return events


def format_fields_for_query(fields):
    &#34;&#34;&#34;
    Format fields names to cann query module.

    Arguments:

    - `fields`: list of fields, i.e. `[&#39;field1&#39;,&#39;name&#39;,&#39;user&#39;]`

    Returns:

        [
            {&#39;name&#39;:&#39;field1&#39;},
            {&#39;name&#39;:&#39;name&#39;},
            {&#39;name&#39;:&#39;user&#39;},
        ]

    &#34;&#34;&#34;
    return [{&#34;name&#34;: value} for value in list(fields)]


def parse_timedelta(time_str):
    &#34;&#34;&#34;
    Parse a time string e.g. (`2h13m`) into a timedelta object.

    Modified from virhilo&#39;s answer at https://stackoverflow.com/a/4628148/851699

    Arguments:

    - `time_str`: A string identifying a duration.  (eg. `2h13m`)


    Returns `datetime.timedelta`: A datetime.timedelta object
    &#34;&#34;&#34;
    regex = re.compile(
        r&#34;^((?P&lt;days&gt;[\.\d]+?)d)?((?P&lt;hours&gt;[\.\d]+?)h)?((?P&lt;minutes&gt;[\.\d]+?)m)?((?P&lt;seconds&gt;[\.\d]+?)s)?$&#34;
    )
    parts = regex.match(time_str)
    assert (
        parts is not None
    ), &#34;Could not parse any time information from &#39;{}&#39;.  Examples of valid strings: &#39;8h&#39;, &#39;2d8h5m20s&#39;, &#39;2m4s&#39;&#34;.format(
        time_str
    )
    time_params = {
        name: float(param) for name, param in parts.groupdict().items() if param
    }
    return timedelta(**time_params)


# Unused method
# def sanitize_string(strg, valid_chars = &#39;&#39;):
#     &#39;&#39;&#39; Sanitize string
#         Usage:
#             By default returns the string without special characters, underscore replaced with space, and surrounding whitespace removed
#             :valid_chars: By default this function removes all characters. Specifying a string of characters here will skip removing them

#         Edited from https://github.com/AutomationSolutionz/Zeuz_Python_Node/blob/master/Framework/Built_In_Automation/Built_In_Utility/CrossPlatform/BuiltInUtilityFunction.py
#     &#39;&#39;&#39;

#     # Invalid character list (space and underscore are handle separately)
#     invalid_chars = &#39;!&#34;#$%&amp;\&#39;()*+,-./:;&lt;=&gt;?@[\]^`{|}~&#39;

#     # Adjust invalid character list, based on function input
#     for j in range(len(valid_chars)): # For each valid character
#         invalid_chars = invalid_chars.replace(valid_chars[j], &#39;&#39;) # Remove valid character from invalid character list

#     for j in range(0,len(invalid_chars)): # For each invalid character (allows us to only remove those the user hasn&#39;t deemed valid)
#         strg = strg.replace(invalid_chars[j], &#39;&#39;) # Remove invalid character
#         strg = strg.lower() # Convert to lower case
#     if &#39;_&#39; not in valid_chars: strg = strg.replace(&#39;_&#39;, &#39; &#39;) # Underscore to space (unless user wants to keep it)

#     strg = strg.replace(&#39;  &#39;, &#39; &#39;) # Double space to single space
#     strg = strg.strip() # Remove leading and trailing whitespace


#     return strg


def nitro_tz(tz_id):
    &#34;&#34;&#34;Maps McAfee SIEM/Nitro ESM internal timezone IDs to
    the tz database at: http://web.cs.ucla.edu/~eggert/tz/tz-link.htm

    Args:
        tz_id (str/int): McAfee ESM internal timezone ID

    Returns:
        timezone name (str)

    &#34;&#34;&#34;

    tz_map = {
        1: &#34;Pacific/Pago_Pago&#34;,
        2: &#34;Pacific/Honolulu&#34;,
        3: &#34;America/Anchorage&#34;,
        4: &#34;America/Los_Angeles&#34;,
        5: &#34;America/Phoenix&#34;,
        6: &#34;America/Chihuahua&#34;,
        7: &#34;America/Denver&#34;,
        8: &#34;America/Guatemala&#34;,
        9: &#34;America/Chicago&#34;,
        10: &#34;America/Mexico_City&#34;,
        11: &#34;America/Regina&#34;,
        12: &#34;America/Bogota&#34;,
        13: &#34;America/New_York&#34;,
        14: &#34;America/Indiana/Indianapolis&#34;,
        15: &#34;America/Halifax&#34;,
        16: &#34;America/Caracas&#34;,
        17: &#34;America/Santiago&#34;,
        18: &#34;America/St_Johns&#34;,
        19: &#34;America/Sao_Paulo&#34;,
        20: &#34;America/Buenos_Aires&#34;,
        21: &#34;America/Godthab&#34;,
        22: &#34;Atlantic/South_Georgia&#34;,
        23: &#34;Atlantic/Azores&#34;,
        24: &#34;Atlantic/Cape_Verde&#34;,
        25: &#34;Africa/Casablanca&#34;,
        26: &#34;Etc/UTC&#34;,
        27: &#34;Europe/Amsterdam&#34;,
        28: &#34;Europe/Belgrade&#34;,
        29: &#34;Europe/Brussels&#34;,
        30: &#34;Europe/Warsaw&#34;,
        31: &#34;Africa/Tripoli&#34;,
        32: &#34;Europe/Athens&#34;,
        33: &#34;Europe/Bucharest&#34;,
        34: &#34;Africa/Cairo&#34;,
        35: &#34;Africa/Maputo&#34;,
        36: &#34;Europe/Helsinki&#34;,
        37: &#34;Asia/Jerusalem&#34;,
        38: &#34;Asia/Baghdad&#34;,
        39: &#34;Asia/Riyadh&#34;,
        40: &#34;Europe/Moscow&#34;,
        41: &#34;Africa/Nairobi&#34;,
        42: &#34;Asia/Tehran&#34;,
        43: &#34;Asia/Dubai&#34;,
        44: &#34;Asia/Baku&#34;,
        45: &#34;Asia/Kabul&#34;,
        46: &#34;Asia/Yekaterinburg&#34;,
        47: &#34;Asia/Karachi&#34;,
        48: &#34;Asia/Kolkata&#34;,
        49: &#34;Asia/Kathmandu&#34;,
        50: &#34;Asia/Almaty&#34;,
        51: &#34;Asia/Dhaka&#34;,
        52: &#34;Asia/Colombo&#34;,
        53: &#34;Asia/Rangoon&#34;,
        54: &#34;Asia/Bangkok&#34;,
        55: &#34;Asia/Krasnoyarsk&#34;,
        56: &#34;Asia/Shanghai&#34;,
        57: &#34;Asia/Irkutsk&#34;,
        58: &#34;Asia/Singapore&#34;,
        59: &#34;Australia/Perth&#34;,
        60: &#34;Asia/Taipei&#34;,
        61: &#34;Asia/Tokyo&#34;,
        62: &#34;Asia/Seoul&#34;,
        63: &#34;Asia/Yakutsk&#34;,
        64: &#34;Australia/Adelaide&#34;,
        65: &#34;Australia/Darwin&#34;,
        66: &#34;Australia/Brisbane&#34;,
        67: &#34;Australia/Sydney&#34;,
        68: &#34;Pacific/Guam&#34;,
        69: &#34;Australia/Hobart&#34;,
        70: &#34;Asia/Vladivostok&#34;,
        71: &#34;Asia/Magadan&#34;,
        72: &#34;Pacific/Auckland&#34;,
        73: &#34;Pacific/Fiji&#34;,
        74: &#34;Pacific/Tongatapu&#34;,
        75: &#34;Asia/Tbilisi&#34;,
        76: &#34;Europe/Dublin&#34;,
        77: &#34;Europe/Istanbul&#34;,
    }

    return tz_map[tz_id]</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="msiempy.core.utils.dehexify"><code class="name flex">
<span>def <span class="ident">dehexify</span></span>(<span>data)</span>
</code></dt>
<dd>
<div class="desc"><p>A URL and Hexadecimal Decoding Library.
Credit: Larry Dewey. In the case of the SIEM API, this is used only when dealing with the pricate API calls.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L14-L59" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dehexify(data):
    &#34;&#34;&#34;
    A URL and Hexadecimal Decoding Library.
    Credit: Larry Dewey. In the case of the SIEM API, this is used only when dealing with the pricate API calls.
    &#34;&#34;&#34;

    hexen = {
        &#34;\x1c&#34;: &#34;,&#34;,  # Replacing Device Control 1 with a comma.
        &#34;\x11&#34;: &#34;\n&#34;,  # Replacing Device Control 2 with a new line.
        &#34;\x12&#34;: &#34; &#34;,  # Space
        &#34;\x22&#34;: &#39;&#34;&#39;,  # Double Quotes
        &#34;\x23&#34;: &#34;#&#34;,  # Number Symbol
        &#34;\x27&#34;: &#34;&#39;&#34;,  # Single Quote
        &#34;\x28&#34;: &#34;(&#34;,  # Open Parenthesis
        &#34;\x29&#34;: &#34;)&#34;,  # Close Parenthesis
        &#34;\x2b&#34;: &#34;+&#34;,  # Plus Symbol
        &#34;\x2d&#34;: &#34;-&#34;,  # Hyphen Symbol
        &#34;\x2e&#34;: &#34;.&#34;,  # Period, dot, or full stop.
        &#34;\x2f&#34;: &#34;/&#34;,  # Forward Slash or divide symbol.
        &#34;\x7c&#34;: &#34;|&#34;,  # Vertical bar or pipe.
    }

    uri = {
        &#34;%11&#34;: &#34;,&#34;,  # Replacing Device Control 1 with a comma.
        &#34;%12&#34;: &#34;\n&#34;,  # Replacing Device Control 2 with a new line.
        &#34;%20&#34;: &#34; &#34;,  # Space
        &#34;%22&#34;: &#39;&#34;&#39;,  # Double Quotes
        &#34;%23&#34;: &#34;#&#34;,  # Number Symbol
        &#34;%27&#34;: &#34;&#39;&#34;,  # Single Quote
        &#34;%28&#34;: &#34;(&#34;,  # Open Parenthesis
        &#34;%29&#34;: &#34;)&#34;,  # Close Parenthesis
        &#34;%2B&#34;: &#34;+&#34;,  # Plus Symbol
        &#34;%2D&#34;: &#34;-&#34;,  # Hyphen Symbol
        &#34;%2E&#34;: &#34;.&#34;,  # Period, dot, or full stop.
        &#34;%2F&#34;: &#34;/&#34;,  # Forward Slash or divide symbol.
        &#34;%3A&#34;: &#34;:&#34;,  # Colon
        &#34;%7C&#34;: &#34;|&#34;,  # Vertical bar or pipe.
    }

    for (enc, dec) in hexen.items():
        data = data.replace(enc, dec)

    for (enc, dec) in uri.items():
        data = data.replace(enc, dec)

    return data</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.tob64"><code class="name flex">
<span>def <span class="ident">tob64</span></span>(<span>s)</span>
</code></dt>
<dd>
<div class="desc"><p>Encode a string to base64 almost like <code>echo '123' | base64</code> would do.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L78-L83" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def tob64(s):
    &#34;&#34;&#34;
    Encode a string to base64 almost like `echo &#39;123&#39; | base64` would do.
    &#34;&#34;&#34;
    if type(s) is str:
        return base64.b64encode(s.encode(&#34;utf-8&#34;)).decode()</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.fromb64"><code class="name flex">
<span>def <span class="ident">fromb64</span></span>(<span>s)</span>
</code></dt>
<dd>
<div class="desc"><p>Decode a string to base64 almost like <code>echo 'MTIzCg==' | base64 --decode</code> would do.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L86-L91" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fromb64(s):
    &#34;&#34;&#34;
    Decode a string to base64 almost like `echo &#39;MTIzCg==&#39; | base64 --decode` would do.
    &#34;&#34;&#34;
    if type(s) is str:
        return base64.b64decode(s.encode(&#34;utf-8&#34;)).encode()</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.timerange_gettimes"><code class="name flex">
<span>def <span class="ident">timerange_gettimes</span></span>(<span>time_range)</span>
</code></dt>
<dd>
<div class="desc"><p>Convert a string time range to a tuple of datetime objects. Only works for certain time ranges.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L110-L171" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def timerange_gettimes(time_range):
    &#34;&#34;&#34;
    Convert a string time range to a tuple of datetime objects. Only works for certain time ranges.
    &#34;&#34;&#34;
    t = time_range.upper()
    now = datetime.now()
    times = tuple()

    if t == &#34;LAST_MINUTE&#34;:
        times = (now - timedelta(seconds=60), now)

    elif t == &#34;LAST_10_MINUTES&#34;:
        times = (now - timedelta(minutes=10), now)

    elif t == &#34;LAST_30_MINUTES&#34;:
        times = (now - timedelta(minutes=30), now)

    elif t == &#34;LAST_HOUR&#34;:
        times = (now - timedelta(minutes=60), now)

    elif t == &#34;CURRENT_DAY&#34;:
        times = (
            now.replace(hour=0, minute=0, second=0),
            now.replace(hour=23, minute=59, second=59),
        )

    elif t == &#34;PREVIOUS_DAY&#34;:
        yesterday = now - timedelta(hours=24)
        times = (
            yesterday.replace(hour=0, minute=0, second=0),
            yesterday.replace(hour=23, minute=59, second=59),
        )

    elif t == &#34;LAST_24_HOURS&#34;:
        times = (now - timedelta(hours=24), now)

    elif t == &#34;LAST_2_DAYS&#34;:
        times = (now - timedelta(days=2), now)

    elif t == &#34;LAST_3_DAYS&#34;:
        times = (now - timedelta(days=3), now)
    # TODO Support other time ranges
    # elif t == &#39;CURRENT_WEEK&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_WEEK&#39;:
    #     pass
    # elif t == &#39;CURRENT_MONTH&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_MONTH&#39;:
    #     pass
    # elif t == &#39;CURRENT_QUARTER&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_QUARTER&#39;:
    #     pass
    # elif t == &#39;CURRENT_YEAR&#39;:
    #     pass
    # elif t == &#39;PREVIOUS_YEAR&#39;:
    #     pass
    else:
        raise NotImplementedError(&#34;Timerange &#34; + t + &#34; is not supported yet&#34;)

    return (times[0].isoformat(), times[1].isoformat())</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.divide_times"><code class="name flex">
<span>def <span class="ident">divide_times</span></span>(<span>first, last, slots=0, delta=0, time=0)</span>
</code></dt>
<dd>
<div class="desc"><p>Divide the time range based on a delta or on a number of slots or another time,.
Return list of tuple</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L174-L212" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def divide_times(first, last, slots=0, delta=0, time=0):
    &#34;&#34;&#34;
    Divide the time range based on a delta or on a number of slots or another time,.
    Return list of tuple
    &#34;&#34;&#34;

    # parse the dates
    t1 = convert_to_time_obj(first) if not isinstance(first, datetime) else first
    t2 = convert_to_time_obj(last) if not isinstance(last, datetime) else last

    duration = t2 - t1

    if slots == 0:
        if delta == 0:
            if time == 0:
                raise AttributeError(&#34;Either time, slots or delta must be specified&#34;)
            else:
                div = convert_to_time_obj(time) - t1

        elif isinstance(delta, timedelta):
            div = delta
        elif isinstance(delta, str):
            div = parse_timedelta(delta)
        else:
            raise AttributeError(&#34;delta Must be timedelta or str object&#34;)

        slots = int(duration.total_seconds() / div.total_seconds()) + 1

    timeSlot = timedelta(seconds=duration.total_seconds() / slots)

    # print(locals())

    times = list()

    for i in range(slots):
        times.append((t1, t1 + timeSlot))
        t1 += timeSlot

    return times</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.regex_match"><code class="name flex">
<span>def <span class="ident">regex_match</span></span>(<span>regex, string)</span>
</code></dt>
<dd>
<div class="desc"><p>Return True if the string match the regex.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L215-L222" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def regex_match(regex, string):
    &#34;&#34;&#34;
    Return True if the string match the regex.
    &#34;&#34;&#34;
    if re.search(regex, string):
        return True
    else:
        return False</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.format_esm_time"><code class="name flex">
<span>def <span class="ident">format_esm_time</span></span>(<span>esm_time)</span>
</code></dt>
<dd>
<div class="desc"><p>Converts time object to ESM time string.</p>
<p>Arguments:</p>
<ul>
<li><code>time_obj</code> (<code>datetime.datetime</code>)</li>
</ul>
<p>Returns: time string in format <code>2019-04-08T19:35:02.971Z</code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L225-L238" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def format_esm_time(esm_time):
    &#34;&#34;&#34;Converts time object to ESM time string.

    Arguments:

    - `time_obj` (`datetime.datetime`)

    Returns: time string in format `2019-04-08T19:35:02.971Z`
    &#34;&#34;&#34;
    _esm_out_time_fmt = &#34;%m/%d/%Y %H:%M:%S&#34;
    _esm_in_time_fmt = &#34;%Y-%m-%dT%H:%M:%S.000Z&#34;
    if isinstance(esm_time, str):
        esm_time = convert_to_time_obj(esm_time)  # , _esm_out_time_fmt)
    return datetime.strftime(esm_time, _esm_in_time_fmt)</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.convert_to_time_obj"><code class="name flex">
<span>def <span class="ident">convert_to_time_obj</span></span>(<span>time_str)</span>
</code></dt>
<dd>
<div class="desc"><p>Converts given timestamp string to datetime object</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>time_str</code></strong></dt>
<dd>timestamp in format 'YYYY/MM/DD HH:MM:SS',
'MM/DD/YYYY HH:MM:SS', or 'DD/MM/YYYY HH:MM:SS'</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>datetime object or None if no format matches</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L241-L252" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def convert_to_time_obj(time_str):
    &#34;&#34;&#34;
    Converts given timestamp string to datetime object

    Args:
        time_str: timestamp in format &#39;YYYY/MM/DD HH:MM:SS&#39;,
                         &#39;MM/DD/YYYY HH:MM:SS&#39;, or &#39;DD/MM/YYYY HH:MM:SS&#39;

    Returns:
        datetime object or None if no format matches
    &#34;&#34;&#34;
    return dateutil.parser.parse(time_str)</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.parse_query_result"><code class="name flex">
<span>def <span class="ident">parse_query_result</span></span>(<span>columns, rows)</span>
</code></dt>
<dd>
<div class="desc"><p>For input :</p>
<pre><code>columns = [{'name': 'Alert.LastTime'}, {'name': 'Rule.msg'}, {'name': 'Alert.DstIP'}, {'name': 'Alert.IPSIDAlertID'}]
rows =
    [
        {'values': ['09/22/2020 15:51:14', 'Postfix Disconnect from host', '::', '144116287604260864|547123']},
        {'values': ['09/22/2020 15:51:14', 'Postfix Lost connection from host', '::', '144116287604260864|547122']}
    }
</code></pre>
<p>Returns :</p>
<pre><code>[
    {
        "Alert.LastTime":"09/22/2020 15:51:14",
        "Rule.msg":"Postfix Disconnect from host",
        "Alert.DstIP":"::",
        "Alert.IPSIDAlertID":"144116287604260864|547123"
    },
    {
        ...
    },
]
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L255-L289" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_query_result(columns, rows):
    &#34;&#34;&#34;
    For input :

        columns = [{&#39;name&#39;: &#39;Alert.LastTime&#39;}, {&#39;name&#39;: &#39;Rule.msg&#39;}, {&#39;name&#39;: &#39;Alert.DstIP&#39;}, {&#39;name&#39;: &#39;Alert.IPSIDAlertID&#39;}]
        rows =
            [
                {&#39;values&#39;: [&#39;09/22/2020 15:51:14&#39;, &#39;Postfix Disconnect from host&#39;, &#39;::&#39;, &#39;144116287604260864|547123&#39;]},
                {&#39;values&#39;: [&#39;09/22/2020 15:51:14&#39;, &#39;Postfix Lost connection from host&#39;, &#39;::&#39;, &#39;144116287604260864|547122&#39;]}
            }

    Returns :

        [
            {
                &#34;Alert.LastTime&#34;:&#34;09/22/2020 15:51:14&#34;,
                &#34;Rule.msg&#34;:&#34;Postfix Disconnect from host&#34;,
                &#34;Alert.DstIP&#34;:&#34;::&#34;,
                &#34;Alert.IPSIDAlertID&#34;:&#34;144116287604260864|547123&#34;
            },
            {
                ...
            },
        ]

    &#34;&#34;&#34;
    events = list()
    for row in rows:
        event = dict()
        for i in range(len(columns)):
            event.update({columns[i][&#34;name&#34;]: row[&#34;values&#34;][i]})

        events.append(event)

    return events</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.format_fields_for_query"><code class="name flex">
<span>def <span class="ident">format_fields_for_query</span></span>(<span>fields)</span>
</code></dt>
<dd>
<div class="desc"><p>Format fields names to cann query module.</p>
<p>Arguments:</p>
<ul>
<li><code>fields</code>: list of fields, i.e. <code>['field1','name','user']</code></li>
</ul>
<h2 id="returns">Returns</h2>
<p>[
{'name':'field1'},
{'name':'name'},
{'name':'user'},
]</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L292-L309" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def format_fields_for_query(fields):
    &#34;&#34;&#34;
    Format fields names to cann query module.

    Arguments:

    - `fields`: list of fields, i.e. `[&#39;field1&#39;,&#39;name&#39;,&#39;user&#39;]`

    Returns:

        [
            {&#39;name&#39;:&#39;field1&#39;},
            {&#39;name&#39;:&#39;name&#39;},
            {&#39;name&#39;:&#39;user&#39;},
        ]

    &#34;&#34;&#34;
    return [{&#34;name&#34;: value} for value in list(fields)]</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.parse_timedelta"><code class="name flex">
<span>def <span class="ident">parse_timedelta</span></span>(<span>time_str)</span>
</code></dt>
<dd>
<div class="desc"><p>Parse a time string e.g. (<code>2h13m</code>) into a timedelta object.</p>
<p>Modified from virhilo's answer at <a href="https://stackoverflow.com/a/4628148/851699">https://stackoverflow.com/a/4628148/851699</a></p>
<p>Arguments:</p>
<ul>
<li><code>time_str</code>: A string identifying a duration.
(eg. <code>2h13m</code>)</li>
</ul>
<p>Returns <code>datetime.timedelta</code>: A datetime.timedelta object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L312-L337" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_timedelta(time_str):
    &#34;&#34;&#34;
    Parse a time string e.g. (`2h13m`) into a timedelta object.

    Modified from virhilo&#39;s answer at https://stackoverflow.com/a/4628148/851699

    Arguments:

    - `time_str`: A string identifying a duration.  (eg. `2h13m`)


    Returns `datetime.timedelta`: A datetime.timedelta object
    &#34;&#34;&#34;
    regex = re.compile(
        r&#34;^((?P&lt;days&gt;[\.\d]+?)d)?((?P&lt;hours&gt;[\.\d]+?)h)?((?P&lt;minutes&gt;[\.\d]+?)m)?((?P&lt;seconds&gt;[\.\d]+?)s)?$&#34;
    )
    parts = regex.match(time_str)
    assert (
        parts is not None
    ), &#34;Could not parse any time information from &#39;{}&#39;.  Examples of valid strings: &#39;8h&#39;, &#39;2d8h5m20s&#39;, &#39;2m4s&#39;&#34;.format(
        time_str
    )
    time_params = {
        name: float(param) for name, param in parts.groupdict().items() if param
    }
    return timedelta(**time_params)</code></pre>
</details>
</dd>
<dt id="msiempy.core.utils.nitro_tz"><code class="name flex">
<span>def <span class="ident">nitro_tz</span></span>(<span>tz_id)</span>
</code></dt>
<dd>
<div class="desc"><p>Maps McAfee SIEM/Nitro ESM internal timezone IDs to
the tz database at: <a href="http://web.cs.ucla.edu/~eggert/tz/tz-link.htm">http://web.cs.ucla.edu/~eggert/tz/tz-link.htm</a></p>
<h2 id="args">Args</h2>
<p>tz_id (str/int): McAfee ESM internal timezone ID</p>
<h2 id="returns">Returns</h2>
<p>timezone name (str)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/mfesiem/msiempy/blob/9e8b0c6916f28f21c45702d6d62eae155f7735d0/msiempy/core/utils.py#L369-L461" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def nitro_tz(tz_id):
    &#34;&#34;&#34;Maps McAfee SIEM/Nitro ESM internal timezone IDs to
    the tz database at: http://web.cs.ucla.edu/~eggert/tz/tz-link.htm

    Args:
        tz_id (str/int): McAfee ESM internal timezone ID

    Returns:
        timezone name (str)

    &#34;&#34;&#34;

    tz_map = {
        1: &#34;Pacific/Pago_Pago&#34;,
        2: &#34;Pacific/Honolulu&#34;,
        3: &#34;America/Anchorage&#34;,
        4: &#34;America/Los_Angeles&#34;,
        5: &#34;America/Phoenix&#34;,
        6: &#34;America/Chihuahua&#34;,
        7: &#34;America/Denver&#34;,
        8: &#34;America/Guatemala&#34;,
        9: &#34;America/Chicago&#34;,
        10: &#34;America/Mexico_City&#34;,
        11: &#34;America/Regina&#34;,
        12: &#34;America/Bogota&#34;,
        13: &#34;America/New_York&#34;,
        14: &#34;America/Indiana/Indianapolis&#34;,
        15: &#34;America/Halifax&#34;,
        16: &#34;America/Caracas&#34;,
        17: &#34;America/Santiago&#34;,
        18: &#34;America/St_Johns&#34;,
        19: &#34;America/Sao_Paulo&#34;,
        20: &#34;America/Buenos_Aires&#34;,
        21: &#34;America/Godthab&#34;,
        22: &#34;Atlantic/South_Georgia&#34;,
        23: &#34;Atlantic/Azores&#34;,
        24: &#34;Atlantic/Cape_Verde&#34;,
        25: &#34;Africa/Casablanca&#34;,
        26: &#34;Etc/UTC&#34;,
        27: &#34;Europe/Amsterdam&#34;,
        28: &#34;Europe/Belgrade&#34;,
        29: &#34;Europe/Brussels&#34;,
        30: &#34;Europe/Warsaw&#34;,
        31: &#34;Africa/Tripoli&#34;,
        32: &#34;Europe/Athens&#34;,
        33: &#34;Europe/Bucharest&#34;,
        34: &#34;Africa/Cairo&#34;,
        35: &#34;Africa/Maputo&#34;,
        36: &#34;Europe/Helsinki&#34;,
        37: &#34;Asia/Jerusalem&#34;,
        38: &#34;Asia/Baghdad&#34;,
        39: &#34;Asia/Riyadh&#34;,
        40: &#34;Europe/Moscow&#34;,
        41: &#34;Africa/Nairobi&#34;,
        42: &#34;Asia/Tehran&#34;,
        43: &#34;Asia/Dubai&#34;,
        44: &#34;Asia/Baku&#34;,
        45: &#34;Asia/Kabul&#34;,
        46: &#34;Asia/Yekaterinburg&#34;,
        47: &#34;Asia/Karachi&#34;,
        48: &#34;Asia/Kolkata&#34;,
        49: &#34;Asia/Kathmandu&#34;,
        50: &#34;Asia/Almaty&#34;,
        51: &#34;Asia/Dhaka&#34;,
        52: &#34;Asia/Colombo&#34;,
        53: &#34;Asia/Rangoon&#34;,
        54: &#34;Asia/Bangkok&#34;,
        55: &#34;Asia/Krasnoyarsk&#34;,
        56: &#34;Asia/Shanghai&#34;,
        57: &#34;Asia/Irkutsk&#34;,
        58: &#34;Asia/Singapore&#34;,
        59: &#34;Australia/Perth&#34;,
        60: &#34;Asia/Taipei&#34;,
        61: &#34;Asia/Tokyo&#34;,
        62: &#34;Asia/Seoul&#34;,
        63: &#34;Asia/Yakutsk&#34;,
        64: &#34;Australia/Adelaide&#34;,
        65: &#34;Australia/Darwin&#34;,
        66: &#34;Australia/Brisbane&#34;,
        67: &#34;Australia/Sydney&#34;,
        68: &#34;Pacific/Guam&#34;,
        69: &#34;Australia/Hobart&#34;,
        70: &#34;Asia/Vladivostok&#34;,
        71: &#34;Asia/Magadan&#34;,
        72: &#34;Pacific/Auckland&#34;,
        73: &#34;Pacific/Fiji&#34;,
        74: &#34;Pacific/Tongatapu&#34;,
        75: &#34;Asia/Tbilisi&#34;,
        76: &#34;Europe/Dublin&#34;,
        77: &#34;Europe/Istanbul&#34;,
    }

    return tz_map[tz_id]</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="McAfee SIEM API Python wrapper" href="https://mfesiem.github.io/docs/msiempy/index.html">
<img src="https://avatars0.githubusercontent.com/u/50667087?s=200&v=4" alt=""> &nbsp; msiempy
</a>
</header>
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="msiempy.core" href="index.html">msiempy.core</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="msiempy.core.utils.dehexify" href="#msiempy.core.utils.dehexify">dehexify</a></code></li>
<li><code><a title="msiempy.core.utils.tob64" href="#msiempy.core.utils.tob64">tob64</a></code></li>
<li><code><a title="msiempy.core.utils.fromb64" href="#msiempy.core.utils.fromb64">fromb64</a></code></li>
<li><code><a title="msiempy.core.utils.timerange_gettimes" href="#msiempy.core.utils.timerange_gettimes">timerange_gettimes</a></code></li>
<li><code><a title="msiempy.core.utils.divide_times" href="#msiempy.core.utils.divide_times">divide_times</a></code></li>
<li><code><a title="msiempy.core.utils.regex_match" href="#msiempy.core.utils.regex_match">regex_match</a></code></li>
<li><code><a title="msiempy.core.utils.format_esm_time" href="#msiempy.core.utils.format_esm_time">format_esm_time</a></code></li>
<li><code><a title="msiempy.core.utils.convert_to_time_obj" href="#msiempy.core.utils.convert_to_time_obj">convert_to_time_obj</a></code></li>
<li><code><a title="msiempy.core.utils.parse_query_result" href="#msiempy.core.utils.parse_query_result">parse_query_result</a></code></li>
<li><code><a title="msiempy.core.utils.format_fields_for_query" href="#msiempy.core.utils.format_fields_for_query">format_fields_for_query</a></code></li>
<li><code><a title="msiempy.core.utils.parse_timedelta" href="#msiempy.core.utils.parse_timedelta">parse_timedelta</a></code></li>
<li><code><a title="msiempy.core.utils.nitro_tz" href="#msiempy.core.utils.nitro_tz">nitro_tz</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<span>This software is licensed under the <a href="https://github.com/mfesiem/msiempy/blob/master/LICENSE">MIT License</a></span>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>